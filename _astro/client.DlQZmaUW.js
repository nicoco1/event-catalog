async function R(t,e,o){const{callbackUrl:a=window.location.href,redirect:s=!0}={},{prefix:c="/api/auth",...i}={},n=t==="credentials",w=n||t==="email",d=`${`${c}/${n?"callback":"signin"}/${t}`}?${new URLSearchParams(o)}`,u=await fetch(`${c}/csrf`),{csrfToken:f}=await u.json(),l=await fetch(d,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...i,csrfToken:f,callbackUrl:a})}),r=await l.clone().json(),h=new URL(r.url).searchParams.get("error");if(s||!w||!h){window.location.href=r.url??a,r.url.includes("#")&&window.location.reload();return}return l}async function g(t){const{callbackUrl:e=window.location.href,prefix:o="/api/auth"}={},a=await fetch(`${o}/csrf`),{csrfToken:s}=await a.json(),n=(await(await fetch(`${o}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:s,callbackUrl:e})})).json()).url??e;window.location.href=n,n.includes("#")&&window.location.reload()}export{g as a,R as s};
