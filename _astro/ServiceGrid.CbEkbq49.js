import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as o}from"./index.66AI1_x2.js";import{a as j,b as A}from"./url-builder.Ce_ff4_l.js";import{g as T}from"./utils.DYUCIFCE.js";import{S as B,T as D,P as F}from"./components.C4GXEYwZ.js";import{F as S}from"./ServerIcon.Bm0Sn4r6.js";import{F as w,a as P}from"./CircleStackIcon.B3azSDUG.js";import{F as R}from"./RectangleGroupIcon.DKuBn3vz.js";import{B as M}from"./box.Dpj119uS.js";import{F as U}from"./QueueListIcon.CFcY8mzd.js";import{F as _}from"./Squares2X2Icon.BUnB1vlz.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./EnvelopeIcon.CURY145Q.js";import"./createLucideIcon.BukmfUhN.js";const G=o.memo(({message:a,collection:c})=>{const{Icon:l,color:d}=T(a.collection);return e.jsxs("a",{href:j(`/docs/${a.collection}/${a.data.id}/${a.data.version}`),className:"group flex border border-gray-200 items-center gap-1 rounded-md text-[11px] font-medium hover:bg-gray-50 transition-colors duration-200 bg-white",children:[e.jsx("div",{className:"bg-white border-r border-gray-200 px-2 py-1.5 rounded-l-md",children:e.jsx(l,{className:`h-3 w-3 text-${d}-500`})}),e.jsx("span",{className:"px-1 py-1 truncate max-w-[140px]",children:a.data.name})]})}),E=o.memo(({messages:a,type:c,selectedTypes:l})=>{const d=c==="receives"?"blue":"green",h=4,N=a?.filter(r=>l.length===0||l.includes(r.collection)),g=N?.slice(0,h),f=N?N.length-h:0;return e.jsx("div",{className:`flex-1 h-full flex flex-col bg-${d}-100 border border-${d}-300 rounded-lg p-4`,children:e.jsxs("div",{className:"space-y-2 flex-1",children:[g?.map(r=>e.jsx(G,{message:r,collection:r.collection},r.data.name)),f>0&&e.jsx("div",{className:"text-center py-1",children:e.jsxs("p",{className:"text-gray-500 text-[10px]",children:["+ ",f," more"]})}),(!a?.length||l.length>0&&!a?.some(r=>l.includes(r.collection)))&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-[10px]",children:l.length>0?`Service does not ${c} ${l.join(" or ")}`:`Service does not ${c} any messages`})})]})})}),I=o.memo(({service:a,urlParams:c,selectedTypes:l})=>e.jsx("a",{href:A("/architecture/messages",{serviceName:a.data.name,serviceId:a.data.id,domainId:c?.domainId,domainName:c?.domainName}),className:"group hover:bg-pink-50 bg-white border-2 border-dashed border-pink-400 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden ",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(S,{className:"h-5 w-5 text-pink-500"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate group-hover:underline transition-colors duration-200 w-full max-w-[90%]",children:[a.data.name||a.data.id," (v",a.data.version,")"]})]})}),a.data.summary&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 min-h-[2.5rem]",children:a.data.summary}),!c?.serviceName&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(E,{messages:a.data.receives,type:"receives",selectedTypes:l}),e.jsxs("div",{className:"flex items-center gap-2 max-w-[200px]",children:[e.jsx("div",{className:"w-4 h-[2px] bg-blue-200"}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(S,{className:"h-8 w-8 text-pink-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.data.name||a.data.id}),e.jsxs("p",{className:"text-xs text-gray-500",children:["v",a.data.version]})]})]})}),e.jsx("div",{className:"w-4 h-[2px] bg-emerald-200"})]}),e.jsx(E,{messages:a.data.sends,type:"sends",selectedTypes:l})]}),(a.data.readsFrom&&a.data.readsFrom.length>0||a.data.writesTo&&a.data.writesTo.length>0)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-2 gap-4",children:[a.data.readsFrom&&a.data.readsFrom.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-orange-500"}),e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Reads from"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.data.readsFrom.slice(0,3).map(d=>e.jsxs("a",{href:j(`/docs/containers/${d.data.id}/${d.data.version}`),className:"group inline-flex items-center gap-1 px-2 py-1 bg-orange-100 border border-orange-300 rounded-md text-[11px] font-medium hover:bg-orange-200 transition-colors duration-200",children:[e.jsx(w,{className:"h-3 w-3 text-orange-600"}),e.jsx("span",{className:"text-orange-800",children:d.data.name})]},d.id)),a.data.readsFrom.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs text-gray-500",children:["+ ",a.data.readsFrom.length-3," more"]})]})]}),a.data.writesTo&&a.data.writesTo.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-purple-500"}),e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Writes to"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.data.writesTo.slice(0,3).map(d=>e.jsxs("a",{href:j(`/docs/containers/${d.data.id}/${d.data.version}`),className:"group inline-flex items-center gap-1 px-2 py-1 bg-purple-100 border border-purple-300 rounded-md text-[11px] font-medium hover:bg-purple-200 transition-colors duration-200",children:[e.jsx(w,{className:"h-3 w-3 text-purple-600"}),e.jsx("span",{className:"text-purple-800",children:d.data.name})]},d.id)),a.data.writesTo.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs text-gray-500",children:["+ ",a.data.writesTo.length-3," more"]})]})]})]})]})})),W=o.memo(({domain:a,services:c,urlParams:l,selectedTypes:d,isMultiColumn:h,isVisualiserEnabled:N})=>{const g=a.data.domains||[],f=g.map(u=>u.data.services||[]).flat(),r=c.filter(u=>!f.some(i=>i.id===u.data.id));return e.jsxs("div",{className:"space-y-6",children:[r.length>0&&e.jsx("div",{className:`grid gap-6 ${h?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:r.map(u=>e.jsx(I,{service:u,urlParams:l,selectedTypes:d},u.data.id))}),g.map(u=>{const i=a.data.domains?.find(n=>n.data.id===u.data.id);if(!i)return null;const b=c.filter(n=>i.data.services?.some(s=>s.id===n.data.id));return b.length===0?null:e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-orange-500"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[i.data.name," (Subdomain)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[N&&e.jsx("a",{href:j(`/visualiser/domains/${i.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:j(`/docs/domains/${i.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white rounded-md transition-colors duration-200",children:"Read documentation"})]})]}),i.data.entities&&i.data.entities.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-purple-500"}),e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Entities"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.entities.map(n=>e.jsxs("a",{href:j(`/docs/entities/${n.id}`),className:"group inline-flex items-center gap-1 px-2 py-1 bg-purple-100 border border-purple-300 rounded-md text-[11px] font-medium hover:bg-purple-200 transition-colors duration-200",children:[e.jsx(M,{className:"h-3 w-3 text-purple-600"}),e.jsx("span",{className:"text-purple-800",children:n.id})]},n.id))})]}),e.jsx("div",{className:`grid gap-6 ${h?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:b.map(n=>e.jsx(I,{service:n,urlParams:{...l,domainId:i.data.id,domainName:`${i.data.name} (Subdomain)`},selectedTypes:d},n.data.id))})]},i.data.id)})]})});function te({services:a,domains:c,embeded:l,isVisualiserEnabled:d}){const[h,N]=o.useState(""),[g,f]=o.useState(1),[r,u]=o.useState([]),[i,b]=o.useState(!1),n=16,[s,L]=o.useState(null);o.useEffect(()=>{const t=new URLSearchParams(window.location.search);L({serviceIds:t.get("serviceIds")?.split(",").filter(Boolean),domainId:t.get("domainId")||void 0,domainName:t.get("domainName")||void 0,serviceName:t.get("serviceName")||void 0})},[]),o.useEffect(()=>{if(typeof window<"u"){const t=localStorage.getItem("EventCatalog:ServiceColumnLayout");t!==null&&b(t==="multi")}},[]);const k=()=>{const t=!i;b(t),typeof window<"u"&&localStorage.setItem("EventCatalog:ServiceColumnLayout",t?"multi":"single")},m=o.useMemo(()=>{if(s===null)return[];let t=[...a];if(s.serviceIds?.length&&(t=t.filter(x=>s.serviceIds?.includes(x.data.id)&&!x.data.id.includes("/versioned/"))),h){const x=h.toLowerCase();t=t.filter(p=>p.data.name?.toLowerCase().includes(x)||p.data.summary?.toLowerCase().includes(x)||p.data.sends?.some(v=>v.data.name.toLowerCase().includes(x))||p.data.receives?.some(v=>v.data.name.toLowerCase().includes(x)))}return r.length>0&&(t=t.filter(x=>{const p=x.data.sends?.some(y=>r.includes(y.collection)),v=x.data.receives?.some(y=>r.includes(y.collection));return p||v})),t.sort((x,p)=>(x.data.name||x.data.id).localeCompare(p.data.name||p.data.id)),t},[a,h,s,r]),$=o.useMemo(()=>{if(s?.domainId||s?.serviceIds?.length)return m;const t=(g-1)*n;return m.slice(t,t+n)},[m,g,s]),C=o.useMemo(()=>s?.domainId||s?.serviceIds?.length?1:Math.ceil(m.length/n),[m.length,s]);return o.useEffect(()=>{f(1)},[h,r]),e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:j("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Domains"]}),e.jsx(P,{className:"h-4 w-4"}),e.jsxs("a",{href:j("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"Services"]}),s?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:s.domainId})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:s?.domainId?`${s.domainName} Architecture`:"All Services"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:s?.domainId?`Browse services and messages in the ${s.domainId} domain`:"Browse and discover services in your event-driven architecture"})]}),e.jsxs("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0 flex items-center gap-3",children:[e.jsx(B,{searchQuery:h,onSearchChange:N,placeholder:"Search services by name, summary, or messages...",totalResults:m.length,totalItems:a.length}),e.jsx("button",{onClick:k,className:"flex items-center justify-center p-2 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors duration-200",title:i?"Switch to single column":"Switch to multi column",children:i?e.jsx(U,{className:"h-5 w-5 text-gray-600"}):e.jsx(_,{className:"h-5 w-5 text-gray-600"})})]})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(D,{selectedTypes:r,onTypeChange:u,filteredCount:m.length,totalCount:a.length}),e.jsx("div",{className:"text-sm text-gray-500",children:s?.domainId||s?.serviceIds?.length?e.jsxs("span",{children:["Showing ",m.length," services in the ",s.domainId," domain"]}):e.jsxs("span",{children:["Showing ",(g-1)*n+1," to"," ",Math.min(g*n,m.length)," of ",m.length," ","services"]})}),!(s?.domainId||s?.serviceIds?.length)&&e.jsx(F,{currentPage:g,totalPages:C,totalItems:m.length,itemsPerPage:n,onPageChange:f})]})}),m.length>0&&e.jsx("div",{className:`rounded-xl overflow-hidden ${s?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-400":""}`,children:s?.domainName?c.filter(t=>t.data.id===s.domainId).map(t=>e.jsx(W,{domain:t,services:$,urlParams:s,selectedTypes:r,isMultiColumn:i,isVisualiserEnabled:d},t.data.id)):e.jsx("div",{className:`grid gap-6 ${i?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:$.map(t=>e.jsx(I,{service:t,urlParams:s,selectedTypes:r},t.data.id))})}),m.length===0&&e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-lg",children:r.length>0?`No services found that ${r.length>1?"handle":"handles"} ${r.join(" or ")} messages`:"No services found matching your criteria"})}),!(s?.domainId||s?.serviceIds?.length)&&e.jsx("div",{className:"mt-8 border-t border-gray-200",children:e.jsx(F,{currentPage:g,totalPages:C,totalItems:m.length,itemsPerPage:n,onPageChange:f})})]})}export{te as default};
