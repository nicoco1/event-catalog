import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as i}from"./index.66AI1_x2.js";import{a as o,b as T}from"./url-builder.Ce_ff4_l.js";import{g as L}from"./utils.DYUCIFCE.js";import{S as W,T as U,P as z}from"./components.C4GXEYwZ.js";import{F as P}from"./RectangleGroupIcon.DKuBn3vz.js";import{a as j,F as b}from"./CircleStackIcon.B3azSDUG.js";import{F as m}from"./ServerIcon.Bm0Sn4r6.js";import{F as A}from"./EnvelopeIcon.CURY145Q.js";import"./_commonjsHelpers.Cpj98o6Y.js";function X({messages:f,embeded:x,containers:v,isVisualiserEnabled:I}){const[g,R]=i.useState(""),[r,S]=i.useState(null),[y,_]=i.useState(1),[h,M]=i.useState([]),[u,$]=i.useState("all"),N=15;i.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("serviceId")||void 0,t=s.get("serviceName")?decodeURIComponent(s.get("serviceName")):void 0,n=s.get("domainId")||void 0,p=s.get("domainName")||void 0;S({serviceId:a,serviceName:t,domainId:n,domainName:p})},[]);const l=i.useMemo(()=>{if(r===null)return[];let s=[...f];if(h.length>0&&(s=s.filter(a=>h.includes(a.collection))),u==="no-producers"?s=s.filter(a=>!a.data.producers||a.data.producers.length===0):u==="no-consumers"&&(s=s.filter(a=>!a.data.consumers||a.data.consumers.length===0)),r.serviceId&&(s=s.filter(a=>a.data.producers?.some(t=>t.id===r.serviceId&&!t.id.includes("/versioned/"))||a.data.consumers?.some(t=>t.id===r.serviceId&&!t.id.includes("/versioned/")))),g){const a=g.toLowerCase();s=s.filter(t=>t.data.name?.toLowerCase().includes(a)||t.data.summary?.toLowerCase().includes(a)||t.data.producers?.some(n=>n.data.id?.toLowerCase().includes(a))||t.data.consumers?.some(n=>n.data.id?.toLowerCase().includes(a)))}return s.sort((a,t)=>a.data.name.localeCompare(t.data.name)),s},[f,g,r,h,u]),F=i.useMemo(()=>r?.serviceId||r?.domainId?1:Math.ceil(l.length/N),[l.length,r]),k=i.useMemo(()=>{if(r?.serviceId||r?.domainId)return l;const s=(y-1)*N;return l.slice(s,s+N)},[l,y,r]);i.useEffect(()=>{_(1)},[g,h]);const c=i.useMemo(()=>{if(!r?.serviceId)return{all:l};const s=r.serviceId,a=l.filter(n=>n.data.producers?.some(p=>p.id===s)),t=l.filter(n=>n.data.consumers?.some(p=>p.id===s));return{sends:a,receives:t}},[l,r]),d=i.useMemo(()=>!r?.serviceId||!v?{writesTo:[],readsFrom:[]}:{writesTo:v.filter(s=>s.data.servicesThatWriteToContainer?.some(a=>a.data.id===r.serviceId)),readsFrom:v.filter(s=>s.data.servicesThatReadFromContainer?.some(a=>a.data.id===r.serviceId))},[v,r]),E=()=>e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(U,{selectedTypes:h,onTypeChange:M,filteredCount:l.filter(s=>h.includes(s.collection)).length})}),e.jsx("div",{className:"flex items-center gap-2 border-l border-gray-200 pl-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:u,onChange:s=>$(s.target.value),className:"block rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-primary sm:text-sm sm:leading-6",children:[e.jsx("option",{value:"all",children:"All Messages"}),e.jsx("option",{value:"no-producers",children:"Without Producers"}),e.jsx("option",{value:"no-consumers",children:"Without Consumers"})]}),u!=="all"&&e.jsx("button",{onClick:()=>$("all"),className:"text-xs text-gray-500 hover:text-gray-700 hover:underline",children:"Clear"})]})})]}),w=s=>e.jsx("div",{className:`grid ${r?.serviceName?"grid-cols-1":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"} gap-6`,children:s.map(a=>{const{color:t,Icon:n}=L(a.collection);return e.jsx("a",{href:o(`/docs/${a.collection}/${a.data.id}/${a.data.version}`),className:`group bg-white border hover:bg-${t}-100  rounded-lg shadow-sm  hover:shadow-lg transition-all duration-200 overflow-hidden border-${t}-500 `,children:e.jsxs("div",{className:"p-4 py-2 flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[!x&&e.jsx(n,{className:`h-5 w-5 text-${t}-500`}),e.jsxs("h3",{className:`font-semibold text-gray-900 truncate group-hover:text-${t}-500 transition-colors duration-200 ${x?"text-sm":"text-md"}`,children:[a.data.name," (v",a.data.version,")"]})]})}),a.data.summary&&e.jsx("p",{className:"text-gray-600 text-xs line-clamp-2 mb-4",children:a.data.summary}),!r?.serviceName&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(m,{className:"h-5 w-5 text-pink-500"})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.data.producers?.length??0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Producers"})]}),e.jsxs("div",{className:"text-center border-l border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(m,{className:"h-5 w-5 text-pink-500"})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.data.consumers?.length??0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Consumers"})]})]})})]})},a.data.name)})}),C=()=>F<=1||r?.serviceName||r?.domainId?null:e.jsx(z,{currentPage:y,totalPages:F,totalItems:l.length,itemsPerPage:N,onPageChange:_});return e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:o("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Domains"]}),e.jsx(j,{className:"h-4 w-4"}),e.jsxs("a",{href:o("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(m,{className:"h-4 w-4"}),"Services"]}),e.jsx(j,{className:"h-4 w-4"}),e.jsxs("a",{href:o("/architecture/messages"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Messages"]}),r?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("a",{href:T("/architecture/services",{domainName:r.domainName,domainId:r.domainId,serviceName:r.serviceName,serviceId:r.serviceId}),className:"hover:text-gray-700 hover:underline",children:r.domainId})]}),r?.serviceName&&e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:r.serviceName})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:r?.domainName?`Messages in ${r.serviceName}`:"All Messages"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:r?.domainName?`Browse messages in the ${r.serviceName} service`:"Browse and discover messages in your event-driven architecture"})]}),e.jsx("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0",children:e.jsx(W,{searchQuery:g,onSearchChange:R,placeholder:"Search messages by name, summary, or services...",totalResults:l.length,totalItems:f.length})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[E(),C()]})}),l.length>0&&e.jsxs("div",{className:`rounded-xl overflow-hidden ${r?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-300":""}`,children:[r?.domainName&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-yellow-500"}),e.jsx("a",{href:T("/architecture/services",{domainName:r.domainName,domainId:r.domainId}),className:"text-2xl font-semibold text-gray-900 hover:underline",children:r.domainName})]}),e.jsxs("div",{className:"flex gap-2",children:[I&&e.jsx("a",{href:o(`/visualiser/domains/${r.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:o(`/docs/domains/${r.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white  rounded-md transition-colors duration-200",children:"Read documentation"})]})]})}),e.jsx("div",{className:`rounded-xl overflow-hidden ${r?.serviceName?"bg-pink-50 p-8 border-2 border-dashed border-pink-300":""}`,children:r?.serviceName?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx(m,{className:"h-6 w-6 text-pink-500"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:r.serviceName}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[I&&e.jsx("a",{href:o(`/visualiser/services/${r.serviceId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200 hover:bg-gray-50",children:"View in visualizer"}),e.jsx("a",{href:o(`/docs/services/${r.serviceId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white rounded-md transition-colors duration-200 hover:bg-gray-50",children:"Read documentation"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8 relative",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 bg-opacity-50 border border-blue-300 border-dashed rounded-lg p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${x?"text-sm":"text-xl"}`,children:[e.jsx(m,{className:"h-5 w-5 text-blue-500"}),"Receives (",c.receives?.length||0,")"]})}),c.receives&&c.receives.length>0?w(c.receives):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"No messages"})})]}),d.readsFrom&&d.readsFrom.length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-300 border-dashed rounded-lg p-4 relative",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${x?"text-sm":"text-xl"}`,children:[e.jsx(b,{className:"h-5 w-5 text-orange-500"}),"Reads from (",d.readsFrom.length,")"]})}),e.jsx("div",{className:"space-y-3",children:d.readsFrom.map(s=>e.jsxs("a",{href:o(`/docs/containers/${s.data.id}/${s.data.version}`),className:"group bg-white border border-orange-200 hover:bg-orange-100 rounded-lg p-3 block transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-orange-500"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm group-hover:text-orange-700",children:s.data.name})]}),s.data.summary&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:s.data.summary})]},s.data.id))}),e.jsxs("div",{className:"absolute -right-8 top-1/2 -translate-y-1/2 flex items-center justify-center w-16 z-10",children:[e.jsx("div",{className:"absolute left-0 w-4 h-4 border-b-[3px] border-l-[3px] border-orange-200 transform rotate-45 -translate-x-1 translate-y-[-1px] shadow-[-1px_1px_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"w-full h-[3px] bg-orange-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"})]})]})]}),e.jsxs("div",{className:"absolute left-[30%] top-[25%] -translate-y-1/2 flex items-center justify-center w-16",children:[e.jsx("div",{className:"w-full h-[3px] bg-blue-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"absolute right-0 w-4 h-4 border-t-[3px] border-r-[3px] border-blue-200 transform rotate-45 translate-x-1 translate-y-[-1px] shadow-[1px_-1px_0_1px_rgba(0,0,0,0.1)]"})]}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-6 flex flex-col justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(m,{className:"h-12 w-12 text-pink-500"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900 text-center",children:r.serviceName}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3 mt-2",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.receives?.length||0}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Receives"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.sends?.length||0}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Sends"})]}),d.readsFrom&&d.readsFrom.length>0&&e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:d.readsFrom.length}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Reads from"})]}),d.writesTo&&d.writesTo.length>0&&e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d.writesTo.length}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Writes to"})]})]})]})}),e.jsxs("div",{className:"absolute right-[30%] top-[25%] -translate-y-1/2 flex items-center justify-center w-16",children:[e.jsx("div",{className:"w-full h-[3px] bg-green-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"absolute right-0 w-4 h-4 border-t-[3px] border-r-[3px] border-green-200 transform rotate-45 translate-x-1 translate-y-[-1px] shadow-[1px_-1px_0_1px_rgba(0,0,0,0.1)]"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-300 border-dashed rounded-lg p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${x?"text-sm":"text-xl"}`,children:[e.jsx(m,{className:"h-5 w-5 text-emerald-500"}),"Sends (",c.sends?.length||0,")"]})}),c.sends&&c.sends.length>0?w(c.sends):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"No messages"})})]}),d.writesTo&&d.writesTo.length>0&&e.jsxs("div",{className:"bg-purple-50 border border-purple-300 border-dashed rounded-lg p-4 relative",children:[e.jsxs("div",{className:"absolute -left-8 top-1/2 -translate-y-1/2 flex items-center justify-center w-16 z-10",children:[e.jsx("div",{className:"w-full h-[3px] bg-purple-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"absolute right-0 w-4 h-4 border-t-[3px] border-r-[3px] border-purple-200 transform rotate-45 translate-x-1 translate-y-[-1px] shadow-[1px_-1px_0_1px_rgba(0,0,0,0.1)]"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${x?"text-sm":"text-xl"}`,children:[e.jsx(b,{className:"h-5 w-5 text-purple-500"}),"Writes to (",d.writesTo.length,")"]})}),e.jsx("div",{className:"space-y-3",children:d.writesTo.map(s=>e.jsxs("a",{href:o(`/docs/containers/${s.data.id}/${s.data.version}`),className:"group bg-white border border-purple-200 hover:bg-purple-100 rounded-lg p-3 block transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-purple-500"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm group-hover:text-purple-700",children:s.data.name})]}),s.data.summary&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:s.data.summary})]},s.data.id))})]})]})]})]}):e.jsxs(e.Fragment,{children:[w(k),e.jsx("div",{className:"mt-8 border-t border-gray-200",children:C()})]})})]}),l.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No messages found matching your criteria"})})]})}export{X as default};
