import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as c}from"./index.66AI1_x2.js";import{u as B,c as F,a as j,d as K,e as v,k as q}from"./index.DTNPTf-c.js";import{c as I,R as H,A as V,C as z,I as W,G as X,L as J,a as Q,b as Y,d as Z,e as ee,S as oe,f as re,g as ne,h as te}from"./index.DLUWrONH.js";import{a as M,t as ae}from"./url-builder.Ce_ff4_l.js";import{C as se}from"./chevron-down.CdffG64G.js";import{C as A,S,F as b,M as R}from"./square-pen.DcpjThHI.js";import{E as ie}from"./external-link.Cc5NOFPQ.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./index.BXXhdAF5.js";import"./floating-ui.dom.CMverA8Q.js";import"./createLucideIcon.BukmfUhN.js";var C="DropdownMenu",[ce]=F(C,[I]),u=I(),[pe,k]=ce(C),E=o=>{const{__scopeDropdownMenu:t,children:a,dir:n,open:r,defaultOpen:s,onOpenChange:m,modal:p=!0}=o,w=u(t),y=c.useRef(null),[d,g]=B({prop:r,defaultProp:s??!1,onChange:m,caller:C});return e.jsx(pe,{scope:t,triggerId:j(),triggerRef:y,contentId:j(),open:d,onOpenChange:g,onOpenToggle:c.useCallback(()=>g(l=>!l),[g]),modal:p,children:e.jsx(H,{...w,open:d,onOpenChange:g,dir:n,modal:p,children:a})})};E.displayName=C;var T="DropdownMenuTrigger",P=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,disabled:n=!1,...r}=o,s=k(T,a),m=u(a);return e.jsx(V,{asChild:!0,...m,children:e.jsx(K.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...r,ref:q(t,s.triggerRef),onPointerDown:v(o.onPointerDown,p=>{!n&&p.button===0&&p.ctrlKey===!1&&(s.onOpenToggle(),s.open||p.preventDefault())}),onKeyDown:v(o.onKeyDown,p=>{n||(["Enter"," "].includes(p.key)&&s.onOpenToggle(),p.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});P.displayName=T;var O="DropdownMenuContent",G=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=k(O,a),s=u(a),m=c.useRef(!1);return e.jsx(z,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...n,ref:t,onCloseAutoFocus:v(o.onCloseAutoFocus,p=>{m.current||r.triggerRef.current?.focus(),m.current=!1,p.preventDefault()}),onInteractOutside:v(o.onInteractOutside,p=>{const w=p.detail.originalEvent,y=w.button===0&&w.ctrlKey===!0,d=w.button===2||y;(!r.modal||d)&&(m.current=!0)}),style:{...o.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});G.displayName=O;var de="DropdownMenuGroup",ue=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(X,{...r,...n,ref:t})});ue.displayName=de;var le="DropdownMenuLabel",we=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(J,{...r,...n,ref:t})});we.displayName=le;var fe="DropdownMenuItem",L=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(W,{...r,...n,ref:t})});L.displayName=fe;var me="DropdownMenuCheckboxItem",ge=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(Q,{...r,...n,ref:t})});ge.displayName=me;var xe="DropdownMenuRadioGroup",he=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(Y,{...r,...n,ref:t})});he.displayName=xe;var ye="DropdownMenuRadioItem",Me=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(Z,{...r,...n,ref:t})});Me.displayName=ye;var be="DropdownMenuItemIndicator",ve=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(ee,{...r,...n,ref:t})});ve.displayName=be;var Ce="DropdownMenuSeparator",De=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(oe,{...r,...n,ref:t})});De.displayName=Ce;var Ne="DropdownMenuArrow",_e=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(re,{...r,...n,ref:t})});_e.displayName=Ne;var je="DropdownMenuSubTrigger",Ae=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(ne,{...r,...n,ref:t})});Ae.displayName=je;var Se="DropdownMenuSubContent",Re=c.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=u(a);return e.jsx(te,{...r,...n,ref:t,style:{...o.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Re.displayName=Se;var Ie=E,ke=P,Ee=G,x=L;const h=({icon:o,title:t,description:a,external:n=!1})=>{let r;if(c.isValidElement(o))r=o;else{const s=o;r=e.jsx(s,{className:"w-5 h-5 text-gray-500"})}return e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-sm",children:[e.jsx("div",{className:"p-1 border border-gray-200 rounded",children:r}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-800",children:t}),e.jsx("div",{className:"text-xs text-gray-500",children:a})]}),n&&e.jsx(ie,{className:"w-4 h-4 text-gray-400"})]})};function Ve({schemas:o,chatQuery:t,chatEnabled:a=!1,editUrl:n,markdownDownloadEnabled:r=!1}){const s={copyMarkdown:r,editPage:!!n,copySchemas:o.length>0,viewMarkdown:r,chat:a};if(!Object.values(s).some(Boolean))return null;const p=window.location.href,w=ae(p),d=s.copyMarkdown?{type:"copyMarkdown",text:"Copy page",icon:A}:s.editPage?{type:"editPage",text:"Edit page",icon:S}:s.copySchemas?{type:"copySchemas",text:"Copy schema",icon:b}:s.viewMarkdown?{type:"viewMarkdown",text:"View Markdown",icon:b}:s.chat?{type:"chat",text:"Open Chat",icon:R}:null,[g,l]=c.useState(d?.text||"Action"),N=async()=>{console.log("Copying markdown to clipboard");try{l("Copied");const i=await fetch(w);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const f=await i.text();await navigator.clipboard.writeText(f),setTimeout(()=>l(d?.text||"Action"),3e3)}catch(i){console.error("Failed to copy markdown:",i),l("Copy failed"),setTimeout(()=>l(d?.text||"Action"),3e3)}},_=async i=>{if(i.url){console.log("Copying schema to clipboard from:",i.url);try{l("Copied Schema");const f=await fetch(i.url);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const D=await f.text();await navigator.clipboard.writeText(D),setTimeout(()=>l(d?.text||"Action"),3e3)}catch(f){console.error("Failed to copy schema:",f),l("Copy failed"),setTimeout(()=>l(d?.text||"Action"),3e3)}}},$=()=>{if(d)switch(d.type){case"copyMarkdown":N();break;case"editPage":window.open(n,"_blank");break;case"copySchemas":_(o[0]);break;case"viewMarkdown":window.open(w,"_blank");break;case"chat":window.open(M(`/chat?query=${t}`));break}};return d?e.jsxs(Ie,{children:[e.jsxs("div",{className:"inline-flex rounded-md shadow-sm border border-gray-300",children:[e.jsxs("button",{type:"button",onClick:$,className:"inline-flex items-center justify-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white rounded-l-md hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx(d.icon,{className:"w-4 h-4"}),g]}),e.jsx(ke,{asChild:!0,children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-1.5 py-1.5 text-sm font-medium text-gray-500 bg-white rounded-r-md border-l border-gray-300 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500","aria-label":"More options",children:e.jsx(se,{className:"w-4 h-4"})})})]}),e.jsxs(Ee,{className:"w-72 bg-white rounded-lg shadow-lg border border-gray-200 mt-1 py-1",sideOffset:5,align:"end",children:[s.copyMarkdown&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>N(),children:e.jsx(h,{icon:A,title:"Copy page",description:"Copy page as Markdown for LLMs"})}),s.editPage&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(n,"_blank"),children:e.jsx(h,{icon:S,title:"Edit page",description:"Edit the contents of this page",external:!0})}),s.copySchemas&&o.map(i=>{const f=i.format==="asyncapi"?"Copy AsyncAPI specification":i.format==="openapi"?"Copy OpenAPI specification":"Copy schema",D=i.format==="asyncapi"||i.format==="openapi"?"specification":`${i.format.toUpperCase()} schema`,U=i.format==="asyncapi"?e.jsx("img",{src:M("/icons/asyncapi.svg",!0),className:"w-4 h-4"}):i.format==="openapi"?e.jsx("img",{src:M("/icons/openapi.svg",!0),className:"w-4 h-4"}):b;return e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>_(i),children:e.jsx(h,{icon:U,title:f,description:`Copy ${D} to clipboard`})},i.url)}),s.viewMarkdown&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(w,"_blank"),children:e.jsx(h,{icon:b,title:"View as Markdown",description:"View this page as plain text",external:!0})}),s.chat&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(M("/chat")+`?query=${t}`),children:e.jsx(h,{icon:R,title:"Open in EventCatalog Chat",description:"Ask questions about this page",external:!0})})]})]}):null}export{Ve as default};
