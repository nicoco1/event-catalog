import{r as d}from"./index.66AI1_x2.js";import{a as v}from"./index.daetGfa_.js";function w(e,t,o){let n=new Set(t).add(void 0);return e.listen((a,i,s)=>{n.has(s)&&o(a,i,s)})}let c=(e,t)=>o=>{e.current!==o&&(e.current=o,t())};function m(e,{keys:t,deps:o=[e,t]}={}){let n=d.useRef();n.current=e.get();let a=d.useCallback(s=>(c(n,s)(e.value),t?.length>0?w(e,t,c(n,s)):e.listen(c(n,s))),o),i=()=>n.current;return d.useSyncExternalStore(a,i,i)}const u="eventcatalog-sidebar-favorites",r=v([]),f=()=>{if(typeof window<"u")try{const e=localStorage.getItem(u);if(e){const t=JSON.parse(e);JSON.stringify(r.get())!==e&&r.set(t)}}catch(e){console.warn("Failed to load favorites:",e)}};typeof window<"u"&&(f(),window.addEventListener("storage",e=>{e.key===u&&f()}),window.addEventListener("favorites-updated",()=>{f()}));const l=e=>{if(r.set(e),typeof window<"u")try{localStorage.setItem(u,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("favorites-updated"))}catch(t){console.warn("Failed to save favorites:",t)}},y=e=>{const t=r.get();t.some(n=>n.nodeKey===e.nodeKey)||l([...t,e])},g=e=>{const t=r.get();l(t.filter(o=>o.nodeKey!==e))},E=e=>{r.get().some(n=>n.nodeKey===e.nodeKey)?g(e.nodeKey):y(e)};export{r as f,E as t,m as u};
