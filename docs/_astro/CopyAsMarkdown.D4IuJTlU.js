import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as p}from"./index.66AI1_x2.js";import{u as K,c as V,a as j,d as q,e as v,k as H}from"./index.BKRqKadn.js";import{c as E,R as z,A as W,C as X,I as J,G as Q,L as Y,a as Z,b as ee,d as oe,e as re,S as ne,f as te,g as ae,h as se}from"./index.Byep-eFf.js";import{b,t as ie}from"./url-builder.Dzt11NIp.js";import{C as ce,S as R,F as M,R as A,M as k}from"./square-pen.CYMWY9JE.js";import{C as I}from"./copy.BwLeP_fT.js";import{E as pe}from"./external-link.Cc5NOFPQ.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./index.pGnXyoOV.js";import"./index.BXXhdAF5.js";import"./floating-ui.react-dom.D0kM9J3o.js";import"./floating-ui.dom.BTe-0RMz.js";import"./createLucideIcon.BukmfUhN.js";var C="DropdownMenu",[de]=V(C,[E]),l=E(),[ue,T]=de(C),P=o=>{const{__scopeDropdownMenu:t,children:a,dir:n,open:r,defaultOpen:c,onOpenChange:s,modal:d=!0}=o,m=l(t),g=p.useRef(null),[y,u]=K({prop:r,defaultProp:c??!1,onChange:s,caller:C});return e.jsx(ue,{scope:t,triggerId:j(),triggerRef:g,contentId:j(),open:y,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(D=>!D),[u]),modal:d,children:e.jsx(z,{...m,open:y,onOpenChange:u,dir:n,modal:d,children:a})})};P.displayName=C;var O="DropdownMenuTrigger",G=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,disabled:n=!1,...r}=o,c=T(O,a),s=l(a);return e.jsx(W,{asChild:!0,...s,children:e.jsx(q.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...r,ref:H(t,c.triggerRef),onPointerDown:v(o.onPointerDown,d=>{!n&&d.button===0&&d.ctrlKey===!1&&(c.onOpenToggle(),c.open||d.preventDefault())}),onKeyDown:v(o.onKeyDown,d=>{n||(["Enter"," "].includes(d.key)&&c.onOpenToggle(),d.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});G.displayName=O;var F="DropdownMenuContent",L=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=T(F,a),c=l(a),s=p.useRef(!1);return e.jsx(X,{id:r.contentId,"aria-labelledby":r.triggerId,...c,...n,ref:t,onCloseAutoFocus:v(o.onCloseAutoFocus,d=>{s.current||r.triggerRef.current?.focus(),s.current=!1,d.preventDefault()}),onInteractOutside:v(o.onInteractOutside,d=>{const m=d.detail.originalEvent,g=m.button===0&&m.ctrlKey===!0,y=m.button===2||g;(!r.modal||y)&&(s.current=!0)}),style:{...o.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});L.displayName=F;var le="DropdownMenuGroup",we=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(Q,{...r,...n,ref:t})});we.displayName=le;var fe="DropdownMenuLabel",me=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(Y,{...r,...n,ref:t})});me.displayName=fe;var ge="DropdownMenuItem",$=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(J,{...r,...n,ref:t})});$.displayName=ge;var xe="DropdownMenuCheckboxItem",he=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(Z,{...r,...n,ref:t})});he.displayName=xe;var ye="DropdownMenuRadioGroup",be=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(ee,{...r,...n,ref:t})});be.displayName=ye;var Me="DropdownMenuRadioItem",ve=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(oe,{...r,...n,ref:t})});ve.displayName=Me;var Ce="DropdownMenuItemIndicator",De=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(re,{...r,...n,ref:t})});De.displayName=Ce;var Ne="DropdownMenuSeparator",Se=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(ne,{...r,...n,ref:t})});Se.displayName=Ne;var _e="DropdownMenuArrow",je=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(te,{...r,...n,ref:t})});je.displayName=_e;var Re="DropdownMenuSubTrigger",Ae=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(ae,{...r,...n,ref:t})});Ae.displayName=Re;var ke="DropdownMenuSubContent",Ie=p.forwardRef((o,t)=>{const{__scopeDropdownMenu:a,...n}=o,r=l(a);return e.jsx(se,{...r,...n,ref:t,style:{...o.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ie.displayName=ke;var Ee=P,Te=G,Pe=L,x=$;const h=({icon:o,title:t,description:a,external:n=!1})=>{let r;if(p.isValidElement(o))r=o;else{const c=o;r=e.jsx(c,{className:"w-5 h-5 text-gray-500"})}return e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-sm",children:[e.jsx("div",{className:"p-1 border border-gray-200 rounded",children:r}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-800",children:t}),e.jsx("div",{className:"text-xs text-gray-500",children:a})]}),n&&e.jsx(pe,{className:"w-4 h-4 text-gray-400"})]})};function Je({schemas:o,chatQuery:t,chatEnabled:a=!1,editUrl:n,markdownDownloadEnabled:r=!1,rssFeedEnabled:c=!1}){const s={copyMarkdown:r,editPage:!!n,copySchemas:o.length>0,viewMarkdown:r,chat:a,rssFeed:c};if(!Object.values(s).some(Boolean))return null;const m=window.location.href,g=ie(m),u=s.copyMarkdown?{type:"copyMarkdown",text:"Copy page",icon:I}:s.editPage?{type:"editPage",text:"Edit page",icon:R}:s.copySchemas?{type:"copySchemas",text:"Copy schema",icon:M}:s.viewMarkdown?{type:"viewMarkdown",text:"View Markdown",icon:M}:s.chat?{type:"chat",text:"Open Chat",icon:k}:s.rssFeed?{type:"rssFeed",text:"RSS Feed",icon:A}:null,[D,f]=p.useState(u?.text||"Action"),S=async()=>{console.log("Copying markdown to clipboard");try{f("Copied");const i=await fetch(g);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const w=await i.text();await navigator.clipboard.writeText(w),setTimeout(()=>f(u?.text||"Action"),3e3)}catch(i){console.error("Failed to copy markdown:",i),f("Copy failed"),setTimeout(()=>f(u?.text||"Action"),3e3)}},_=async i=>{if(i.url){console.log("Copying schema to clipboard from:",i.url);try{f("Copied Schema");const w=await fetch(i.url);if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);const N=await w.text();await navigator.clipboard.writeText(N),setTimeout(()=>f(u?.text||"Action"),3e3)}catch(w){console.error("Failed to copy schema:",w),f("Copy failed"),setTimeout(()=>f(u?.text||"Action"),3e3)}}},U=()=>{if(u)switch(u.type){case"copyMarkdown":S();break;case"editPage":window.open(n,"_blank");break;case"copySchemas":_(o[0]);break;case"viewMarkdown":window.open(g,"_blank");break;case"chat":window.open(b(`/chat?query=${t}`));break}};return u?e.jsxs(Ee,{children:[e.jsxs("div",{className:"inline-flex rounded-md shadow-sm border border-gray-300",children:[e.jsxs("button",{type:"button",onClick:U,className:"inline-flex items-center justify-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white rounded-l-md hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx(u.icon,{className:"w-4 h-4"}),D]}),e.jsx(Te,{asChild:!0,children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center px-1.5 py-1.5 text-sm font-medium text-gray-500 bg-white rounded-r-md border-l border-gray-300 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500","aria-label":"More options",children:e.jsx(ce,{className:"w-4 h-4"})})})]}),e.jsxs(Pe,{className:"w-72 bg-white rounded-lg shadow-lg border border-gray-200 mt-1 py-1",sideOffset:5,align:"end",children:[s.copyMarkdown&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>S(),children:e.jsx(h,{icon:I,title:"Copy page",description:"Copy page as Markdown for LLMs"})}),s.editPage&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(n,"_blank"),children:e.jsx(h,{icon:R,title:"Edit page",description:"Edit the contents of this page",external:!0})}),s.copySchemas&&o.map(i=>{const w=i.format==="asyncapi"?"Copy AsyncAPI specification":i.format==="openapi"?"Copy OpenAPI specification":"Copy schema",N=i.format==="asyncapi"||i.format==="openapi"?"specification":`${i.format.toUpperCase()} schema`,B=i.format==="asyncapi"?e.jsx("img",{src:b("/icons/asyncapi.svg",!0),className:"w-4 h-4"}):i.format==="openapi"?e.jsx("img",{src:b("/icons/openapi.svg",!0),className:"w-4 h-4"}):M;return e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>_(i),children:e.jsx(h,{icon:B,title:w,description:`Copy ${N} to clipboard`})},i.url)}),s.viewMarkdown&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(g,"_blank"),children:e.jsx(h,{icon:M,title:"View as Markdown",description:"View this page as plain text",external:!0})}),s.rssFeed&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(b("/rss/all/rss.xml"),"_blank"),children:e.jsx(h,{icon:A,title:"RSS Feed",description:"View this page as RSS feed",external:!0})}),s.chat&&e.jsx(x,{className:"cursor-pointer hover:bg-gray-100 focus:outline-none focus:bg-gray-100",onSelect:()=>window.open(b("/chat")+`?query=${t}`),children:e.jsx(h,{icon:k,title:"Open in EventCatalog Chat",description:"Ask questions about this page",external:!0})})]})]}):null}export{Je as default};
