import{j as d}from"./jsx-runtime.DCqPeNwG.js";import{r as Z}from"./index.66AI1_x2.js";import{k as z,w as Vn,o as Ee,V as Ar,p as Wn,u as Jn,r as Bn,l as qn,m as Gn,n as Kn,v as Hn}from"./index.CYbN6hFM.js";import{g as Pr}from"./_commonjsHelpers.Cpj98o6Y.js";import{h as Yn,p as Xn}from"./index.DXj_uSRK.js";import{R as Qn,P as ea,O as ta,C as ra,T as na}from"./index.DvWqczMf.js";import{B as Me,S as ke,M as aa,T as Rt,X as Mt,a as Dt,b as sa}from"./x.CZKWv4Q_.js";import{s as It,h as oa,f as ia,a as ca,b as ua}from"./index.dom.MoK_LCF9.js";import{C as la}from"./check.Bh7Hnhg7.js";import{C as pa}from"./copy.BwLeP_fT.js";import"./index.BKRqKadn.js";import"./index.pGnXyoOV.js";import"./index.BXXhdAF5.js";import"./createLucideIcon.BukmfUhN.js";const da={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};var Zr="vercel.ai.error",fa=Symbol.for(Zr),Cr,ma=class Or extends Error{constructor({name:t,message:r,cause:n}){super(r),this[Cr]=!0,this.name=t,this.cause=n}static isInstance(t){return Or.hasMarker(t,Zr)}static hasMarker(t,r){const n=Symbol.for(r);return t!=null&&typeof t=="object"&&n in t&&typeof t[n]=="boolean"&&t[n]===!0}};Cr=fa;var se=ma;function Rr(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var Mr="AI_InvalidArgumentError",Dr=`vercel.ai.error.${Mr}`,ha=Symbol.for(Dr),Lr,ga=class extends se{constructor({message:e,cause:t,argument:r}){super({name:Mr,message:e,cause:t}),this[Lr]=!0,this.argument=r}static isInstance(e){return se.hasMarker(e,Dr)}};Lr=ha;var Fr="AI_JSONParseError",Ur=`vercel.ai.error.${Fr}`,va=Symbol.for(Ur),Vr,Lt=class extends se{constructor({text:e,cause:t}){super({name:Fr,message:`JSON parsing failed: Text: ${e}.
Error message: ${Rr(t)}`,cause:t}),this[Vr]=!0,this.text=e}static isInstance(e){return se.hasMarker(e,Ur)}};Vr=va;var Wr="AI_TypeValidationError",Jr=`vercel.ai.error.${Wr}`,ya=Symbol.for(Jr),Br,ba=class gt extends se{constructor({value:t,cause:r}){super({name:Wr,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Rr(r)}`,cause:r}),this[Br]=!0,this.value=t}static isInstance(t){return se.hasMarker(t,Jr)}static wrap({value:t,cause:r}){return gt.isInstance(r)&&r.value===t?r:new gt({value:t,cause:r})}};Br=ya;var Be=ba;class Ft extends Error{constructor(t,r){super(t),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function ot(e){}function _a(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=ot,onError:r=ot,onRetry:n=ot,onComment:a}=e;let s="",i=!0,o,u="",c="";function p(h){const y=i?h.replace(/^\xEF\xBB\xBF/,""):h,[w,x]=xa(`${s}${y}`);for(const E of w)l(E);s=x,i=!1}function l(h){if(h===""){v();return}if(h.startsWith(":")){a&&a(h.slice(h.startsWith(": ")?2:1));return}const y=h.indexOf(":");if(y!==-1){const w=h.slice(0,y),x=h[y+1]===" "?2:1,E=h.slice(y+x);b(w,E,h);return}b(h,"",h)}function b(h,y,w){switch(h){case"event":c=y;break;case"data":u=`${u}${y}
`;break;case"id":o=y.includes("\0")?void 0:y;break;case"retry":/^\d+$/.test(y)?n(parseInt(y,10)):r(new Ft(`Invalid \`retry\` value: "${y}"`,{type:"invalid-retry",value:y,line:w}));break;default:r(new Ft(`Unknown field "${h.length>20?`${h.slice(0,20)}â€¦`:h}"`,{type:"unknown-field",field:h,value:y,line:w}));break}}function v(){u.length>0&&t({id:o,event:c||void 0,data:u.endsWith(`
`)?u.slice(0,-1):u}),o=void 0,u="",c=""}function f(h={}){s&&h.consume&&l(s),i=!0,o=void 0,u="",c="",s=""}return{feed:p,reset:f}}function xa(e){const t=[];let r="",n=0;for(;n<e.length;){const a=e.indexOf("\r",n),s=e.indexOf(`
`,n);let i=-1;if(a!==-1&&s!==-1?i=Math.min(a,s):a!==-1?a===e.length-1?i=-1:i=a:s!==-1&&(i=s),i===-1){r=e.slice(n);break}else{const o=e.slice(n,i);t.push(o),n=i+1,e[n-1]==="\r"&&e[n]===`
`&&n++}}return[t,r]}class wa extends TransformStream{constructor({onError:t,onRetry:r,onComment:n}={}){let a;super({start(s){a=_a({onEvent:i=>{s.enqueue(i)},onError(i){t==="terminate"?s.error(i):typeof t=="function"&&t(i)},onRetry:r,onComment:n})},transform(s){a.feed(s)}})}}function m(e,t,r){function n(o,u){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(e),t(o,u);for(const p in i.prototype)p in o||Object.defineProperty(o,p,{value:i.prototype[p].bind(o)});o._zod.constr=i,o._zod.def=u}const a=r?.Parent??Object;class s extends a{}Object.defineProperty(s,"name",{value:e});function i(o){var u;const c=r?.Parent?new s:this;n(c,o),(u=c._zod).deferred??(u.deferred=[]);for(const p of c._zod.deferred)p();return c}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}class je extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const qr={};function oe(e){return qr}function Gr(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,a])=>t.indexOf(+n)===-1).map(([n,a])=>a)}function Ea(e,t){return typeof t=="bigint"?t.toString():t}function St(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Nt(e){return e==null}function Tt(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function ka(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,s=Number.parseInt(e.toFixed(a).replace(".","")),i=Number.parseInt(t.toFixed(a).replace(".",""));return s%i/10**a}function P(e,t,r){Object.defineProperty(e,t,{get(){{const n=r();return e[t]=n,n}},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function Qe(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function _e(e){return JSON.stringify(e)}const Kr=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function qe(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Ia=St(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Ge(e){if(qe(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(qe(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const Sa=new Set(["string","number","symbol"]);function Ze(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function pe(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function k(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Na(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Ta={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function za(e,t){const r={},n=e._zod.def;for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(r[a]=n.shape[a])}return pe(e,{...e._zod.def,shape:r,checks:[]})}function ja(e,t){const r={...e._zod.def.shape},n=e._zod.def;for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&delete r[a]}return pe(e,{...e._zod.def,shape:r,checks:[]})}function $a(e,t){if(!Ge(t))throw new Error("Invalid input to extend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return Qe(this,"shape",n),n},checks:[]};return pe(e,r)}function Aa(e,t){return pe(e,{...e._zod.def,get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return Qe(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})}function Pa(e,t,r){const n=t._zod.def.shape,a={...n};if(r)for(const s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(a[s]=e?new e({type:"optional",innerType:n[s]}):n[s])}else for(const s in n)a[s]=e?new e({type:"optional",innerType:n[s]}):n[s];return pe(t,{...t._zod.def,shape:a,checks:[]})}function Za(e,t,r){const n=t._zod.def.shape,a={...n};if(r)for(const s in r){if(!(s in a))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(a[s]=new e({type:"nonoptional",innerType:n[s]}))}else for(const s in n)a[s]=new e({type:"nonoptional",innerType:n[s]});return pe(t,{...t._zod.def,shape:a,checks:[]})}function ze(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function le(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function De(e){return typeof e=="string"?e:e?.message}function ie(e,t,r){const n={...e,path:e.path??[]};if(!e.message){const a=De(e.inst?._zod.def?.error?.(e))??De(t?.error?.(e))??De(r.customError?.(e))??De(r.localeError?.(e))??"Invalid input";n.message=a}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function zt(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function $e(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const Hr=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,Ea,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Yr=m("$ZodError",Hr),Xr=m("$ZodError",Hr,{Parent:Error});function Ca(e,t=r=>r.message){const r={},n=[];for(const a of e.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}function Oa(e,t){const r=t||function(s){return s.message},n={_errors:[]},a=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(o=>a({issues:o}));else if(i.code==="invalid_key")a({issues:i.issues});else if(i.code==="invalid_element")a({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let o=n,u=0;for(;u<i.path.length;){const c=i.path[u];u===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return a(e),n}const Ra=e=>(t,r,n,a)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new je;if(i.issues.length){const o=new(a?.Err??e)(i.issues.map(u=>ie(u,s,oe())));throw Kr(o,a?.callee),o}return i.value},Ma=e=>async(t,r,n,a)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const o=new(a?.Err??e)(i.issues.map(u=>ie(u,s,oe())));throw Kr(o,a?.callee),o}return i.value},Qr=e=>(t,r,n)=>{const a=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new je;return s.issues.length?{success:!1,error:new(e??Yr)(s.issues.map(i=>ie(i,a,oe())))}:{success:!0,data:s.value}},Da=Qr(Xr),en=e=>async(t,r,n)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},a);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>ie(i,a,oe())))}:{success:!0,data:s.value}},La=en(Xr),Fa=/^[cC][^\s-]{8,}$/,Ua=/^[0-9a-z]+$/,Va=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Wa=/^[0-9a-vA-V]{20}$/,Ja=/^[A-Za-z0-9]{27}$/,Ba=/^[a-zA-Z0-9_-]{21}$/,qa=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Ga=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ut=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,Ka=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ha="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Ya(){return new RegExp(Ha,"u")}const Xa=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Qa=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,es=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ts=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rs=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,tn=/^[A-Za-z0-9_-]*$/,ns=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,as=/^\+(?:[0-9]){6,14}[0-9]$/,rn="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ss=new RegExp(`^${rn}$`);function nn(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function os(e){return new RegExp(`^${nn(e)}$`)}function is(e){const t=nn({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${rn}T(?:${n})$`)}const cs=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},us=/^\d+$/,ls=/^-?\d+(?:\.\d+)?/i,ps=/true|false/i,ds=/null/i,fs=/^[^A-Z]*$/,ms=/^[^a-z]*$/,H=m("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),an={number:"number",bigint:"bigint",object:"date"},sn=m("$ZodCheckLessThan",(e,t)=>{H.init(e,t);const r=an[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,s=(t.inclusive?a.maximum:a.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?a.maximum=t.value:a.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),on=m("$ZodCheckGreaterThan",(e,t)=>{H.init(e,t);const r=an[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,s=(t.inclusive?a.minimum:a.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?a.minimum=t.value:a.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),hs=m("$ZodCheckMultipleOf",(e,t)=>{H.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):ka(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),gs=m("$ZodCheckNumberFormat",(e,t)=>{H.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),n=r?"int":"number",[a,s]=Ta[t.format];e._zod.onattach.push(i=>{const o=i._zod.bag;o.format=t.format,o.minimum=a,o.maximum=s,r&&(o.pattern=us)}),e._zod.check=i=>{const o=i.value;if(r){if(!Number.isInteger(o)){i.issues.push({expected:n,format:t.format,code:"invalid_type",input:o,inst:e});return}if(!Number.isSafeInteger(o)){o>0?i.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):i.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}o<a&&i.issues.push({origin:"number",input:o,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),o>s&&i.issues.push({origin:"number",input:o,code:"too_big",maximum:s,inst:e})}}),vs=m("$ZodCheckMaxLength",(e,t)=>{var r;H.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Nt(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const a=n.value;if(a.length<=t.maximum)return;const i=zt(a);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),ys=m("$ZodCheckMinLength",(e,t)=>{var r;H.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Nt(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const a=n.value;if(a.length>=t.minimum)return;const i=zt(a);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),bs=m("$ZodCheckLengthEquals",(e,t)=>{var r;H.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!Nt(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=n=>{const a=n.value,s=a.length;if(s===t.length)return;const i=zt(a),o=s>t.length;n.issues.push({origin:i,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),et=m("$ZodCheckStringFormat",(e,t)=>{var r,n;H.init(e,t),e._zod.onattach.push(a=>{const s=a._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),_s=m("$ZodCheckRegex",(e,t)=>{et.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),xs=m("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=fs),et.init(e,t)}),ws=m("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=ms),et.init(e,t)}),Es=m("$ZodCheckIncludes",(e,t)=>{H.init(e,t);const r=Ze(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(a=>{const s=a._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),ks=m("$ZodCheckStartsWith",(e,t)=>{H.init(e,t);const r=new RegExp(`^${Ze(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),Is=m("$ZodCheckEndsWith",(e,t)=>{H.init(e,t);const r=new RegExp(`.*${Ze(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),Ss=m("$ZodCheckOverwrite",(e,t)=>{H.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class Ns{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),a=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(a)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,r=this?.args,a=[...(this?.content??[""]).map(s=>`  ${s}`)];return new t(...r,a.join(`
`))}}const Ts={major:4,minor:0,patch:0},O=m("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Ts;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const a of n)for(const s of a._zod.onattach)s(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const a=(s,i,o)=>{let u=ze(s),c;for(const p of i){if(p._zod.def.when){if(!p._zod.def.when(s))continue}else if(u)continue;const l=s.issues.length,b=p._zod.check(s);if(b instanceof Promise&&o?.async===!1)throw new je;if(c||b instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await b,s.issues.length!==l&&(u||(u=ze(s,l)))});else{if(s.issues.length===l)continue;u||(u=ze(s,l))}}return c?c.then(()=>s):s};e._zod.run=(s,i)=>{const o=e._zod.parse(s,i);if(o instanceof Promise){if(i.async===!1)throw new je;return o.then(u=>a(u,n,i))}return a(o,n,i)}}e["~standard"]={validate:a=>{try{const s=Da(e,a);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return La(e,a).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),jt=m("$ZodString",(e,t)=>{O.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??cs(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),M=m("$ZodStringFormat",(e,t)=>{et.init(e,t),jt.init(e,t)}),zs=m("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Ga),M.init(e,t)}),js=m("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Ut(n))}else t.pattern??(t.pattern=Ut());M.init(e,t)}),$s=m("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Ka),M.init(e,t)}),As=m("$ZodURL",(e,t)=>{M.init(e,t),e._zod.check=r=>{try{const n=r.value,a=new URL(n),s=a.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:ns.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Ps=m("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Ya()),M.init(e,t)}),Zs=m("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Ba),M.init(e,t)}),Cs=m("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Fa),M.init(e,t)}),Os=m("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Ua),M.init(e,t)}),Rs=m("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Va),M.init(e,t)}),Ms=m("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Wa),M.init(e,t)}),Ds=m("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Ja),M.init(e,t)}),Ls=m("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=is(t)),M.init(e,t)}),Fs=m("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=ss),M.init(e,t)}),Us=m("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=os(t)),M.init(e,t)}),Vs=m("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=qa),M.init(e,t)}),Ws=m("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Xa),M.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),Js=m("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Qa),M.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Bs=m("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=es),M.init(e,t)}),qs=m("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=ts),M.init(e,t),e._zod.check=r=>{const[n,a]=r.value.split("/");try{if(!a)throw new Error;const s=Number(a);if(`${s}`!==a)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function cn(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Gs=m("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=rs),M.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{cn(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Ks(e){if(!tn.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return cn(r)}const Hs=m("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=tn),M.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{Ks(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Ys=m("$ZodE164",(e,t)=>{t.pattern??(t.pattern=as),M.init(e,t)});function Xs(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const a=JSON.parse(atob(n));return!("typ"in a&&a?.typ!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const Qs=m("$ZodJWT",(e,t)=>{M.init(e,t),e._zod.check=r=>{Xs(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),un=m("$ZodNumber",(e,t)=>{O.init(e,t),e._zod.pattern=e._zod.bag.pattern??ls,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const a=r.value;if(typeof a=="number"&&!Number.isNaN(a)&&Number.isFinite(a))return r;const s=typeof a=="number"?Number.isNaN(a)?"NaN":Number.isFinite(a)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:a,inst:e,...s?{received:s}:{}}),r}}),eo=m("$ZodNumber",(e,t)=>{gs.init(e,t),un.init(e,t)}),to=m("$ZodBoolean",(e,t)=>{O.init(e,t),e._zod.pattern=ps,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}const a=r.value;return typeof a=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:a,inst:e}),r}}),ro=m("$ZodNull",(e,t)=>{O.init(e,t),e._zod.pattern=ds,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{const a=r.value;return a===null||r.issues.push({expected:"null",code:"invalid_type",input:a,inst:e}),r}}),no=m("$ZodUnknown",(e,t)=>{O.init(e,t),e._zod.parse=r=>r}),ao=m("$ZodNever",(e,t)=>{O.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function Vt(e,t,r){e.issues.length&&t.issues.push(...le(r,e.issues)),t.value[r]=e.value}const so=m("$ZodArray",(e,t)=>{O.init(e,t),e._zod.parse=(r,n)=>{const a=r.value;if(!Array.isArray(a))return r.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),r;r.value=Array(a.length);const s=[];for(let i=0;i<a.length;i++){const o=a[i],u=t.element._zod.run({value:o,issues:[]},n);u instanceof Promise?s.push(u.then(c=>Vt(c,r,i))):Vt(u,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Le(e,t,r){e.issues.length&&t.issues.push(...le(r,e.issues)),t.value[r]=e.value}function Wt(e,t,r,n){e.issues.length?n[r]===void 0?r in n?t.value[r]=void 0:t.value[r]=e.value:t.issues.push(...le(r,e.issues)):e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}const oo=m("$ZodObject",(e,t)=>{O.init(e,t);const r=St(()=>{const l=Object.keys(t.shape);for(const v of l)if(!(t.shape[v]instanceof O))throw new Error(`Invalid element at key "${v}": expected a Zod schema`);const b=Na(t.shape);return{shape:t.shape,keys:l,keySet:new Set(l),numKeys:l.length,optionalKeys:new Set(b)}});P(e._zod,"propValues",()=>{const l=t.shape,b={};for(const v in l){const f=l[v]._zod;if(f.values){b[v]??(b[v]=new Set);for(const h of f.values)b[v].add(h)}}return b});const n=l=>{const b=new Ns(["shape","payload","ctx"]),v=r.value,f=x=>{const E=_e(x);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};b.write("const input = payload.value;");const h=Object.create(null);let y=0;for(const x of v.keys)h[x]=`key_${y++}`;b.write("const newResult = {}");for(const x of v.keys)if(v.optionalKeys.has(x)){const E=h[x];b.write(`const ${E} = ${f(x)};`);const g=_e(x);b.write(`
        if (${E}.issues.length) {
          if (input[${g}] === undefined) {
            if (${g} in input) {
              newResult[${g}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${g}, ...iss.path] : [${g}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${g} in input) newResult[${g}] = undefined;
        } else {
          newResult[${g}] = ${E}.value;
        }
        `)}else{const E=h[x];b.write(`const ${E} = ${f(x)};`),b.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${_e(x)}, ...iss.path] : [${_e(x)}]
          })));`),b.write(`newResult[${_e(x)}] = ${E}.value`)}b.write("payload.value = newResult;"),b.write("return payload;");const w=b.compile();return(x,E)=>w(l,x,E)};let a;const s=qe,i=!qr.jitless,u=i&&Ia.value,c=t.catchall;let p;e._zod.parse=(l,b)=>{p??(p=r.value);const v=l.value;if(!s(v))return l.issues.push({expected:"object",code:"invalid_type",input:v,inst:e}),l;const f=[];if(i&&u&&b?.async===!1&&b.jitless!==!0)a||(a=n(t.shape)),l=a(l,b);else{l.value={};const E=p.shape;for(const g of p.keys){const $=E[g],A=$._zod.run({value:v[g],issues:[]},b),T=$._zod.optin==="optional"&&$._zod.optout==="optional";A instanceof Promise?f.push(A.then(N=>T?Wt(N,l,g,v):Le(N,l,g))):T?Wt(A,l,g,v):Le(A,l,g)}}if(!c)return f.length?Promise.all(f).then(()=>l):l;const h=[],y=p.keySet,w=c._zod,x=w.def.type;for(const E of Object.keys(v)){if(y.has(E))continue;if(x==="never"){h.push(E);continue}const g=w.run({value:v[E],issues:[]},b);g instanceof Promise?f.push(g.then($=>Le($,l,E))):Le(g,l,E)}return h.length&&l.issues.push({code:"unrecognized_keys",keys:h,input:v,inst:e}),f.length?Promise.all(f).then(()=>l):l}});function Jt(e,t,r,n){for(const a of e)if(a.issues.length===0)return t.value=a.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(a=>a.issues.map(s=>ie(s,n,oe())))}),t}const ln=m("$ZodUnion",(e,t)=>{O.init(e,t),P(e._zod,"optin",()=>t.options.some(r=>r._zod.optin==="optional")?"optional":void 0),P(e._zod,"optout",()=>t.options.some(r=>r._zod.optout==="optional")?"optional":void 0),P(e._zod,"values",()=>{if(t.options.every(r=>r._zod.values))return new Set(t.options.flatMap(r=>Array.from(r._zod.values)))}),P(e._zod,"pattern",()=>{if(t.options.every(r=>r._zod.pattern)){const r=t.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>Tt(n.source)).join("|")})$`)}}),e._zod.parse=(r,n)=>{let a=!1;const s=[];for(const i of t.options){const o=i._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)s.push(o),a=!0;else{if(o.issues.length===0)return o;s.push(o)}}return a?Promise.all(s).then(i=>Jt(i,r,e,n)):Jt(s,r,e,n)}}),io=m("$ZodDiscriminatedUnion",(e,t)=>{ln.init(e,t);const r=e._zod.parse;P(e._zod,"propValues",()=>{const a={};for(const s of t.options){const i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const[o,u]of Object.entries(i)){a[o]||(a[o]=new Set);for(const c of u)a[o].add(c)}}return a});const n=St(()=>{const a=t.options,s=new Map;for(const i of a){const o=i._zod.propValues[t.discriminator];if(!o||o.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(i)}"`);for(const u of o){if(s.has(u))throw new Error(`Duplicate discriminator value "${String(u)}"`);s.set(u,i)}}return s});e._zod.parse=(a,s)=>{const i=a.value;if(!qe(i))return a.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),a;const o=n.value.get(i?.[t.discriminator]);return o?o._zod.run(a,s):t.unionFallback?r(a,s):(a.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[t.discriminator],inst:e}),a)}}),co=m("$ZodIntersection",(e,t)=>{O.init(e,t),e._zod.parse=(r,n)=>{const a=r.value,s=t.left._zod.run({value:a,issues:[]},n),i=t.right._zod.run({value:a,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([u,c])=>Bt(r,u,c)):Bt(r,s,i)}});function vt(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Ge(e)&&Ge(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),a={...e,...t};for(const s of n){const i=vt(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};a[s]=i.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const a=e[n],s=t[n],i=vt(a,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Bt(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),ze(e))return e;const n=vt(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const uo=m("$ZodRecord",(e,t)=>{O.init(e,t),e._zod.parse=(r,n)=>{const a=r.value;if(!Ge(a))return r.issues.push({expected:"record",code:"invalid_type",input:a,inst:e}),r;const s=[];if(t.keyType._zod.values){const i=t.keyType._zod.values;r.value={};for(const u of i)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){const c=t.valueType._zod.run({value:a[u],issues:[]},n);c instanceof Promise?s.push(c.then(p=>{p.issues.length&&r.issues.push(...le(u,p.issues)),r.value[u]=p.value})):(c.issues.length&&r.issues.push(...le(u,c.issues)),r.value[u]=c.value)}let o;for(const u in a)i.has(u)||(o=o??[],o.push(u));o&&o.length>0&&r.issues.push({code:"unrecognized_keys",input:a,inst:e,keys:o})}else{r.value={};for(const i of Reflect.ownKeys(a)){if(i==="__proto__")continue;const o=t.keyType._zod.run({value:i,issues:[]},n);if(o instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(o.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:o.issues.map(c=>ie(c,n,oe())),input:i,path:[i],inst:e}),r.value[o.value]=o.value;continue}const u=t.valueType._zod.run({value:a[i],issues:[]},n);u instanceof Promise?s.push(u.then(c=>{c.issues.length&&r.issues.push(...le(i,c.issues)),r.value[o.value]=c.value})):(u.issues.length&&r.issues.push(...le(i,u.issues)),r.value[o.value]=u.value)}}return s.length?Promise.all(s).then(()=>r):r}}),lo=m("$ZodEnum",(e,t)=>{O.init(e,t);const r=Gr(t.entries);e._zod.values=new Set(r),e._zod.pattern=new RegExp(`^(${r.filter(n=>Sa.has(typeof n)).map(n=>typeof n=="string"?Ze(n):n.toString()).join("|")})$`),e._zod.parse=(n,a)=>{const s=n.value;return e._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:e}),n}}),po=m("$ZodLiteral",(e,t)=>{O.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?Ze(r):r?r.toString():String(r)).join("|")})$`),e._zod.parse=(r,n)=>{const a=r.value;return e._zod.values.has(a)||r.issues.push({code:"invalid_value",values:t.values,input:a,inst:e}),r}}),fo=m("$ZodTransform",(e,t)=>{O.init(e,t),e._zod.parse=(r,n)=>{const a=t.transform(r.value,r);if(n.async)return(a instanceof Promise?a:Promise.resolve(a)).then(i=>(r.value=i,r));if(a instanceof Promise)throw new je;return r.value=a,r}}),mo=m("$ZodOptional",(e,t)=>{O.init(e,t),e._zod.optin="optional",e._zod.optout="optional",P(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),P(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Tt(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>t.innerType._zod.optin==="optional"?t.innerType._zod.run(r,n):r.value===void 0?r:t.innerType._zod.run(r,n)}),ho=m("$ZodNullable",(e,t)=>{O.init(e,t),P(e._zod,"optin",()=>t.innerType._zod.optin),P(e._zod,"optout",()=>t.innerType._zod.optout),P(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${Tt(r.source)}|null)$`):void 0}),P(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),go=m("$ZodDefault",(e,t)=>{O.init(e,t),e._zod.optin="optional",P(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=t.defaultValue,r;const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>qt(s,t)):qt(a,t)}});function qt(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const vo=m("$ZodPrefault",(e,t)=>{O.init(e,t),e._zod.optin="optional",P(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),yo=m("$ZodNonOptional",(e,t)=>{O.init(e,t),P(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>Gt(s,e)):Gt(a,e)}});function Gt(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const bo=m("$ZodCatch",(e,t)=>{O.init(e,t),e._zod.optin="optional",P(e._zod,"optout",()=>t.innerType._zod.optout),P(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>ie(i,n,oe()))},input:r.value}),r.issues=[]),r)):(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(s=>ie(s,n,oe()))},input:r.value}),r.issues=[]),r)}}),_o=m("$ZodPipe",(e,t)=>{O.init(e,t),P(e._zod,"values",()=>t.in._zod.values),P(e._zod,"optin",()=>t.in._zod.optin),P(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(r,n)=>{const a=t.in._zod.run(r,n);return a instanceof Promise?a.then(s=>Kt(s,t,n)):Kt(a,t,n)}});function Kt(e,t,r){return ze(e)?e:t.out._zod.run({value:e.value,issues:e.issues},r)}const xo=m("$ZodReadonly",(e,t)=>{O.init(e,t),P(e._zod,"propValues",()=>t.innerType._zod.propValues),P(e._zod,"values",()=>t.innerType._zod.values),P(e._zod,"optin",()=>t.innerType._zod.optin),P(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(Ht):Ht(a)}});function Ht(e){return e.value=Object.freeze(e.value),e}const wo=m("$ZodLazy",(e,t)=>{O.init(e,t),P(e._zod,"innerType",()=>t.getter()),P(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),P(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),P(e._zod,"optin",()=>e._zod.innerType._zod.optin),P(e._zod,"optout",()=>e._zod.innerType._zod.optout),e._zod.parse=(r,n)=>e._zod.innerType._zod.run(r,n)}),Eo=m("$ZodCustom",(e,t)=>{H.init(e,t),O.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,a=t.fn(n);if(a instanceof Promise)return a.then(s=>Yt(s,r,n,e));Yt(a,r,n,e)}});function Yt(e,t,r,n){if(!e){const a={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(a.params=n._zod.def.params),t.issues.push($e(a))}}class pn{constructor(){this._map=new Map,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}}function ko(){return new pn}const Ie=ko();function Io(e,t){return new e({type:"string",...k(t)})}function So(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...k(t)})}function Xt(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...k(t)})}function No(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...k(t)})}function To(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...k(t)})}function zo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...k(t)})}function jo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...k(t)})}function $o(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...k(t)})}function Ao(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...k(t)})}function Po(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...k(t)})}function Zo(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...k(t)})}function Co(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...k(t)})}function Oo(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...k(t)})}function Ro(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...k(t)})}function Mo(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...k(t)})}function Do(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...k(t)})}function Lo(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...k(t)})}function Fo(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...k(t)})}function Uo(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...k(t)})}function Vo(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...k(t)})}function Wo(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...k(t)})}function Jo(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...k(t)})}function Bo(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...k(t)})}function qo(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...k(t)})}function Go(e,t){return new e({type:"string",format:"date",check:"string_format",...k(t)})}function Ko(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...k(t)})}function Ho(e,t){return new e({type:"string",format:"duration",check:"string_format",...k(t)})}function Yo(e,t){return new e({type:"number",checks:[],...k(t)})}function Xo(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...k(t)})}function Qo(e,t){return new e({type:"boolean",...k(t)})}function ei(e,t){return new e({type:"null",...k(t)})}function ti(e){return new e({type:"unknown"})}function ri(e,t){return new e({type:"never",...k(t)})}function Qt(e,t){return new sn({check:"less_than",...k(t),value:e,inclusive:!1})}function it(e,t){return new sn({check:"less_than",...k(t),value:e,inclusive:!0})}function er(e,t){return new on({check:"greater_than",...k(t),value:e,inclusive:!1})}function ct(e,t){return new on({check:"greater_than",...k(t),value:e,inclusive:!0})}function tr(e,t){return new hs({check:"multiple_of",...k(t),value:e})}function dn(e,t){return new vs({check:"max_length",...k(t),maximum:e})}function Ke(e,t){return new ys({check:"min_length",...k(t),minimum:e})}function fn(e,t){return new bs({check:"length_equals",...k(t),length:e})}function ni(e,t){return new _s({check:"string_format",format:"regex",...k(t),pattern:e})}function ai(e){return new xs({check:"string_format",format:"lowercase",...k(e)})}function si(e){return new ws({check:"string_format",format:"uppercase",...k(e)})}function oi(e,t){return new Es({check:"string_format",format:"includes",...k(t),includes:e})}function ii(e,t){return new ks({check:"string_format",format:"starts_with",...k(t),prefix:e})}function ci(e,t){return new Is({check:"string_format",format:"ends_with",...k(t),suffix:e})}function Ce(e){return new Ss({check:"overwrite",tx:e})}function ui(e){return Ce(t=>t.normalize(e))}function li(){return Ce(e=>e.trim())}function pi(){return Ce(e=>e.toLowerCase())}function di(){return Ce(e=>e.toUpperCase())}function fi(e,t,r){return new e({type:"array",element:t,...k(r)})}function mi(e,t,r){const n=k(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function hi(e,t,r){return new e({type:"custom",check:"custom",fn:t,...k(r)})}class rr{constructor(t){this.counter=0,this.metadataRegistry=t?.metadata??Ie,this.target=t?.target??"draft-2020-12",this.unrepresentable=t?.unrepresentable??"throw",this.override=t?.override??(()=>{}),this.io=t?.io??"output",this.seen=new Map}process(t,r={path:[],schemaPath:[]}){var n;const a=t._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(t);if(i)return i.count++,r.schemaPath.includes(t)&&(i.cycle=r.path),i.schema;const o={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(t,o);const u=t._zod.toJSONSchema?.();if(u)o.schema=u;else{const l={...r,schemaPath:[...r.schemaPath,t],path:r.path},b=t._zod.parent;if(b)o.ref=b,this.process(b,l),this.seen.get(b).isParent=!0;else{const v=o.schema;switch(a.type){case"string":{const f=v;f.type="string";const{minimum:h,maximum:y,format:w,patterns:x,contentEncoding:E}=t._zod.bag;if(typeof h=="number"&&(f.minLength=h),typeof y=="number"&&(f.maxLength=y),w&&(f.format=s[w]??w,f.format===""&&delete f.format),E&&(f.contentEncoding=E),x&&x.size>0){const g=[...x];g.length===1?f.pattern=g[0].source:g.length>1&&(o.schema.allOf=[...g.map($=>({...this.target==="draft-7"?{type:"string"}:{},pattern:$.source}))])}break}case"number":{const f=v,{minimum:h,maximum:y,format:w,multipleOf:x,exclusiveMaximum:E,exclusiveMinimum:g}=t._zod.bag;typeof w=="string"&&w.includes("int")?f.type="integer":f.type="number",typeof g=="number"&&(f.exclusiveMinimum=g),typeof h=="number"&&(f.minimum=h,typeof g=="number"&&(g>=h?delete f.minimum:delete f.exclusiveMinimum)),typeof E=="number"&&(f.exclusiveMaximum=E),typeof y=="number"&&(f.maximum=y,typeof E=="number"&&(E<=y?delete f.maximum:delete f.exclusiveMaximum)),typeof x=="number"&&(f.multipleOf=x);break}case"boolean":{const f=v;f.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{v.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{v.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const f=v,{minimum:h,maximum:y}=t._zod.bag;typeof h=="number"&&(f.minItems=h),typeof y=="number"&&(f.maxItems=y),f.type="array",f.items=this.process(a.element,{...l,path:[...l.path,"items"]});break}case"object":{const f=v;f.type="object",f.properties={};const h=a.shape;for(const x in h)f.properties[x]=this.process(h[x],{...l,path:[...l.path,"properties",x]});const y=new Set(Object.keys(h)),w=new Set([...y].filter(x=>{const E=a.shape[x]._zod;return this.io==="input"?E.optin===void 0:E.optout===void 0}));w.size>0&&(f.required=Array.from(w)),a.catchall?._zod.def.type==="never"?f.additionalProperties=!1:a.catchall?a.catchall&&(f.additionalProperties=this.process(a.catchall,{...l,path:[...l.path,"additionalProperties"]})):this.io==="output"&&(f.additionalProperties=!1);break}case"union":{const f=v;f.anyOf=a.options.map((h,y)=>this.process(h,{...l,path:[...l.path,"anyOf",y]}));break}case"intersection":{const f=v,h=this.process(a.left,{...l,path:[...l.path,"allOf",0]}),y=this.process(a.right,{...l,path:[...l.path,"allOf",1]}),w=E=>"allOf"in E&&Object.keys(E).length===1,x=[...w(h)?h.allOf:[h],...w(y)?y.allOf:[y]];f.allOf=x;break}case"tuple":{const f=v;f.type="array";const h=a.items.map((x,E)=>this.process(x,{...l,path:[...l.path,"prefixItems",E]}));if(this.target==="draft-2020-12"?f.prefixItems=h:f.items=h,a.rest){const x=this.process(a.rest,{...l,path:[...l.path,"items"]});this.target==="draft-2020-12"?f.items=x:f.additionalItems=x}a.rest&&(f.items=this.process(a.rest,{...l,path:[...l.path,"items"]}));const{minimum:y,maximum:w}=t._zod.bag;typeof y=="number"&&(f.minItems=y),typeof w=="number"&&(f.maxItems=w);break}case"record":{const f=v;f.type="object",f.propertyNames=this.process(a.keyType,{...l,path:[...l.path,"propertyNames"]}),f.additionalProperties=this.process(a.valueType,{...l,path:[...l.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const f=v,h=Gr(a.entries);h.every(y=>typeof y=="number")&&(f.type="number"),h.every(y=>typeof y=="string")&&(f.type="string"),f.enum=h;break}case"literal":{const f=v,h=[];for(const y of a.values)if(y===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof y=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");h.push(Number(y))}else h.push(y);if(h.length!==0)if(h.length===1){const y=h[0];f.type=y===null?"null":typeof y,f.const=y}else h.every(y=>typeof y=="number")&&(f.type="number"),h.every(y=>typeof y=="string")&&(f.type="string"),h.every(y=>typeof y=="boolean")&&(f.type="string"),h.every(y=>y===null)&&(f.type="null"),f.enum=h;break}case"file":{const f=v,h={type:"string",format:"binary",contentEncoding:"binary"},{minimum:y,maximum:w,mime:x}=t._zod.bag;y!==void 0&&(h.minLength=y),w!==void 0&&(h.maxLength=w),x?x.length===1?(h.contentMediaType=x[0],Object.assign(f,h)):f.anyOf=x.map(E=>({...h,contentMediaType:E})):Object.assign(f,h);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const f=this.process(a.innerType,l);v.anyOf=[f,{type:"null"}];break}case"nonoptional":{this.process(a.innerType,l),o.ref=a.innerType;break}case"success":{const f=v;f.type="boolean";break}case"default":{this.process(a.innerType,l),o.ref=a.innerType,v.default=JSON.parse(JSON.stringify(a.defaultValue));break}case"prefault":{this.process(a.innerType,l),o.ref=a.innerType,this.io==="input"&&(v._prefault=JSON.parse(JSON.stringify(a.defaultValue)));break}case"catch":{this.process(a.innerType,l),o.ref=a.innerType;let f;try{f=a.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}v.default=f;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const f=v,h=t._zod.pattern;if(!h)throw new Error("Pattern not found in template literal");f.type="string",f.pattern=h.source;break}case"pipe":{const f=this.io==="input"?a.in._zod.def.type==="transform"?a.out:a.in:a.out;this.process(f,l),o.ref=f;break}case"readonly":{this.process(a.innerType,l),o.ref=a.innerType,v.readOnly=!0;break}case"promise":{this.process(a.innerType,l),o.ref=a.innerType;break}case"optional":{this.process(a.innerType,l),o.ref=a.innerType;break}case"lazy":{const f=t._zod.innerType;this.process(f,l),o.ref=f;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const c=this.metadataRegistry.get(t);return c&&Object.assign(o.schema,c),this.io==="input"&&W(t)&&(delete o.schema.examples,delete o.schema.default),this.io==="input"&&o.schema._prefault&&((n=o.schema).default??(n.default=o.schema._prefault)),delete o.schema._prefault,this.seen.get(t).schema}emit(t,r){const n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},a=this.seen.get(t);if(!a)throw new Error("Unprocessed schema. This is a bug in Zod.");const s=p=>{const l=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){const h=n.external.registry.get(p[0])?.id,y=n.external.uri??(x=>x);if(h)return{ref:y(h)};const w=p[1].defId??p[1].schema.id??`schema${this.counter++}`;return p[1].defId=w,{defId:w,ref:`${y("__shared")}#/${l}/${w}`}}if(p[1]===a)return{ref:"#"};const v=`#/${l}/`,f=p[1].schema.id??`__schema${this.counter++}`;return{defId:f,ref:v+f}},i=p=>{if(p[1].schema.$ref)return;const l=p[1],{ref:b,defId:v}=s(p);l.def={...l.schema},v&&(l.defId=v);const f=l.schema;for(const h in f)delete f[h];f.$ref=b};if(n.cycles==="throw")for(const p of this.seen.entries()){const l=p[1];if(l.cycle)throw new Error(`Cycle detected: #/${l.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const p of this.seen.entries()){const l=p[1];if(t===p[0]){i(p);continue}if(n.external){const v=n.external.registry.get(p[0])?.id;if(t!==p[0]&&v){i(p);continue}}if(this.metadataRegistry.get(p[0])?.id){i(p);continue}if(l.cycle){i(p);continue}if(l.count>1&&n.reused==="ref"){i(p);continue}}const o=(p,l)=>{const b=this.seen.get(p),v=b.def??b.schema,f={...v};if(b.ref===null)return;const h=b.ref;if(b.ref=null,h){o(h,l);const y=this.seen.get(h).schema;y.$ref&&l.target==="draft-7"?(v.allOf=v.allOf??[],v.allOf.push(y)):(Object.assign(v,y),Object.assign(v,f))}b.isParent||this.override({zodSchema:p,jsonSchema:v,path:b.path??[]})};for(const p of[...this.seen.entries()].reverse())o(p[0],{target:this.target});const u={};if(this.target==="draft-2020-12"?u.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?u.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){const p=n.external.registry.get(t)?.id;if(!p)throw new Error("Schema is missing an `id` property");u.$id=n.external.uri(p)}Object.assign(u,a.def);const c=n.external?.defs??{};for(const p of this.seen.entries()){const l=p[1];l.def&&l.defId&&(c[l.defId]=l.def)}n.external||Object.keys(c).length>0&&(this.target==="draft-2020-12"?u.$defs=c:u.definitions=c);try{return JSON.parse(JSON.stringify(u))}catch{throw new Error("Error converting schema to JSON.")}}}function gi(e,t){if(e instanceof pn){const n=new rr(t),a={};for(const o of e._idmap.entries()){const[u,c]=o;n.process(c)}const s={},i={registry:e,uri:t?.uri,defs:a};for(const o of e._idmap.entries()){const[u,c]=o;s[u]=n.emit(c,{...t,external:i})}if(Object.keys(a).length>0){const o=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[o]:a}}return{schemas:s}}const r=new rr(t);return r.process(e),r.emit(e,t)}function W(e,t){const r=t??{seen:new Set};if(r.seen.has(e))return!1;r.seen.add(e);const a=e._zod.def;switch(a.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return W(a.element,r);case"object":{for(const s in a.shape)if(W(a.shape[s],r))return!0;return!1}case"union":{for(const s of a.options)if(W(s,r))return!0;return!1}case"intersection":return W(a.left,r)||W(a.right,r);case"tuple":{for(const s of a.items)if(W(s,r))return!0;return!!(a.rest&&W(a.rest,r))}case"record":return W(a.keyType,r)||W(a.valueType,r);case"map":return W(a.keyType,r)||W(a.valueType,r);case"set":return W(a.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return W(a.innerType,r);case"lazy":return W(a.getter(),r);case"default":return W(a.innerType,r);case"prefault":return W(a.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return W(a.in,r)||W(a.out,r);case"success":return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${a.type}`)}const vi=m("ZodISODateTime",(e,t)=>{Ls.init(e,t),F.init(e,t)});function yi(e){return qo(vi,e)}const bi=m("ZodISODate",(e,t)=>{Fs.init(e,t),F.init(e,t)});function _i(e){return Go(bi,e)}const xi=m("ZodISOTime",(e,t)=>{Us.init(e,t),F.init(e,t)});function wi(e){return Ko(xi,e)}const Ei=m("ZodISODuration",(e,t)=>{Vs.init(e,t),F.init(e,t)});function ki(e){return Ho(Ei,e)}const Ii=(e,t)=>{Yr.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Oa(e,r)},flatten:{value:r=>Ca(e,r)},addIssue:{value:r=>e.issues.push(r)},addIssues:{value:r=>e.issues.push(...r)},isEmpty:{get(){return e.issues.length===0}}})},tt=m("ZodError",Ii,{Parent:Error}),Si=Ra(tt),Ni=Ma(tt),Ti=Qr(tt),mn=en(tt),D=m("ZodType",(e,t)=>(O.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>pe(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>Si(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>Ti(e,r,n),e.parseAsync=async(r,n)=>Ni(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>mn(e,r,n),e.spa=e.safeParseAsync,e.refine=(r,n)=>e.check(Ec(r,n)),e.superRefine=r=>e.check(kc(r)),e.overwrite=r=>e.check(Ce(r)),e.optional=()=>sr(e),e.nullable=()=>or(e),e.nullish=()=>sr(or(e)),e.nonoptional=r=>mc(e,r),e.array=()=>ve(e),e.or=r=>Q([e,r]),e.and=r=>ac(e,r),e.transform=r=>ir(e,cc(r)),e.default=r=>pc(e,r),e.prefault=r=>fc(e,r),e.catch=r=>gc(e,r),e.pipe=r=>ir(e,r),e.readonly=()=>bc(e),e.describe=r=>{const n=e.clone();return Ie.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){return Ie.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Ie.get(e);const n=e.clone();return Ie.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),hn=m("_ZodString",(e,t)=>{jt.init(e,t),D.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(ni(...n)),e.includes=(...n)=>e.check(oi(...n)),e.startsWith=(...n)=>e.check(ii(...n)),e.endsWith=(...n)=>e.check(ci(...n)),e.min=(...n)=>e.check(Ke(...n)),e.max=(...n)=>e.check(dn(...n)),e.length=(...n)=>e.check(fn(...n)),e.nonempty=(...n)=>e.check(Ke(1,...n)),e.lowercase=n=>e.check(ai(n)),e.uppercase=n=>e.check(si(n)),e.trim=()=>e.check(li()),e.normalize=(...n)=>e.check(ui(...n)),e.toLowerCase=()=>e.check(pi()),e.toUpperCase=()=>e.check(di())}),zi=m("ZodString",(e,t)=>{jt.init(e,t),hn.init(e,t),e.email=r=>e.check(So(ji,r)),e.url=r=>e.check($o($i,r)),e.jwt=r=>e.check(Bo(Bi,r)),e.emoji=r=>e.check(Ao(Ai,r)),e.guid=r=>e.check(Xt(nr,r)),e.uuid=r=>e.check(No(Fe,r)),e.uuidv4=r=>e.check(To(Fe,r)),e.uuidv6=r=>e.check(zo(Fe,r)),e.uuidv7=r=>e.check(jo(Fe,r)),e.nanoid=r=>e.check(Po(Pi,r)),e.guid=r=>e.check(Xt(nr,r)),e.cuid=r=>e.check(Zo(Zi,r)),e.cuid2=r=>e.check(Co(Ci,r)),e.ulid=r=>e.check(Oo(Oi,r)),e.base64=r=>e.check(Vo(Vi,r)),e.base64url=r=>e.check(Wo(Wi,r)),e.xid=r=>e.check(Ro(Ri,r)),e.ksuid=r=>e.check(Mo(Mi,r)),e.ipv4=r=>e.check(Do(Di,r)),e.ipv6=r=>e.check(Lo(Li,r)),e.cidrv4=r=>e.check(Fo(Fi,r)),e.cidrv6=r=>e.check(Uo(Ui,r)),e.e164=r=>e.check(Jo(Ji,r)),e.datetime=r=>e.check(yi(r)),e.date=r=>e.check(_i(r)),e.time=r=>e.check(wi(r)),e.duration=r=>e.check(ki(r))});function I(e){return Io(zi,e)}const F=m("ZodStringFormat",(e,t)=>{M.init(e,t),hn.init(e,t)}),ji=m("ZodEmail",(e,t)=>{$s.init(e,t),F.init(e,t)}),nr=m("ZodGUID",(e,t)=>{zs.init(e,t),F.init(e,t)}),Fe=m("ZodUUID",(e,t)=>{js.init(e,t),F.init(e,t)}),$i=m("ZodURL",(e,t)=>{As.init(e,t),F.init(e,t)}),Ai=m("ZodEmoji",(e,t)=>{Ps.init(e,t),F.init(e,t)}),Pi=m("ZodNanoID",(e,t)=>{Zs.init(e,t),F.init(e,t)}),Zi=m("ZodCUID",(e,t)=>{Cs.init(e,t),F.init(e,t)}),Ci=m("ZodCUID2",(e,t)=>{Os.init(e,t),F.init(e,t)}),Oi=m("ZodULID",(e,t)=>{Rs.init(e,t),F.init(e,t)}),Ri=m("ZodXID",(e,t)=>{Ms.init(e,t),F.init(e,t)}),Mi=m("ZodKSUID",(e,t)=>{Ds.init(e,t),F.init(e,t)}),Di=m("ZodIPv4",(e,t)=>{Ws.init(e,t),F.init(e,t)}),Li=m("ZodIPv6",(e,t)=>{Js.init(e,t),F.init(e,t)}),Fi=m("ZodCIDRv4",(e,t)=>{Bs.init(e,t),F.init(e,t)}),Ui=m("ZodCIDRv6",(e,t)=>{qs.init(e,t),F.init(e,t)}),Vi=m("ZodBase64",(e,t)=>{Gs.init(e,t),F.init(e,t)}),Wi=m("ZodBase64URL",(e,t)=>{Hs.init(e,t),F.init(e,t)}),Ji=m("ZodE164",(e,t)=>{Ys.init(e,t),F.init(e,t)}),Bi=m("ZodJWT",(e,t)=>{Qs.init(e,t),F.init(e,t)}),gn=m("ZodNumber",(e,t)=>{un.init(e,t),D.init(e,t),e.gt=(n,a)=>e.check(er(n,a)),e.gte=(n,a)=>e.check(ct(n,a)),e.min=(n,a)=>e.check(ct(n,a)),e.lt=(n,a)=>e.check(Qt(n,a)),e.lte=(n,a)=>e.check(it(n,a)),e.max=(n,a)=>e.check(it(n,a)),e.int=n=>e.check(ar(n)),e.safe=n=>e.check(ar(n)),e.positive=n=>e.check(er(0,n)),e.nonnegative=n=>e.check(ct(0,n)),e.negative=n=>e.check(Qt(0,n)),e.nonpositive=n=>e.check(it(0,n)),e.multipleOf=(n,a)=>e.check(tr(n,a)),e.step=(n,a)=>e.check(tr(n,a)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function qi(e){return Yo(gn,e)}const Gi=m("ZodNumberFormat",(e,t)=>{eo.init(e,t),gn.init(e,t)});function ar(e){return Xo(Gi,e)}const Ki=m("ZodBoolean",(e,t)=>{to.init(e,t),D.init(e,t)});function K(e){return Qo(Ki,e)}const Hi=m("ZodNull",(e,t)=>{ro.init(e,t),D.init(e,t)});function Yi(e){return ei(Hi,e)}const Xi=m("ZodUnknown",(e,t)=>{no.init(e,t),D.init(e,t)});function ne(){return ti(Xi)}const Qi=m("ZodNever",(e,t)=>{ao.init(e,t),D.init(e,t)});function vn(e){return ri(Qi,e)}const ec=m("ZodArray",(e,t)=>{so.init(e,t),D.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Ke(r,n)),e.nonempty=r=>e.check(Ke(1,r)),e.max=(r,n)=>e.check(dn(r,n)),e.length=(r,n)=>e.check(fn(r,n)),e.unwrap=()=>e.element});function ve(e,t){return fi(ec,e,t)}const yn=m("ZodObject",(e,t)=>{oo.init(e,t),D.init(e,t),P(e,"shape",()=>t.shape),e.keyof=()=>_n(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:ne()}),e.loose=()=>e.clone({...e._zod.def,catchall:ne()}),e.strict=()=>e.clone({...e._zod.def,catchall:vn()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>$a(e,r),e.merge=r=>Aa(e,r),e.pick=r=>za(e,r),e.omit=r=>ja(e,r),e.partial=(...r)=>Pa(xn,e,r[0]),e.required=(...r)=>Za(wn,e,r[0])});function B(e,t){const r={type:"object",get shape(){return Qe(this,"shape",{...e}),this.shape},...k(t)};return new yn(r)}function L(e,t){return new yn({type:"object",get shape(){return Qe(this,"shape",{...e}),this.shape},catchall:vn(),...k(t)})}const bn=m("ZodUnion",(e,t)=>{ln.init(e,t),D.init(e,t),e.options=t.options});function Q(e,t){return new bn({type:"union",options:e,...k(t)})}const tc=m("ZodDiscriminatedUnion",(e,t)=>{bn.init(e,t),io.init(e,t)});function rc(e,t,r){return new tc({type:"union",options:t,discriminator:e,...k(r)})}const nc=m("ZodIntersection",(e,t)=>{co.init(e,t),D.init(e,t)});function ac(e,t){return new nc({type:"intersection",left:e,right:t})}const sc=m("ZodRecord",(e,t)=>{uo.init(e,t),D.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function yt(e,t,r){return new sc({type:"record",keyType:e,valueType:t,...k(r)})}const bt=m("ZodEnum",(e,t)=>{lo.init(e,t),D.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,a)=>{const s={};for(const i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new bt({...t,checks:[],...k(a),entries:s})},e.exclude=(n,a)=>{const s={...t.entries};for(const i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new bt({...t,checks:[],...k(a),entries:s})}});function _n(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new bt({type:"enum",entries:r,...k(t)})}const oc=m("ZodLiteral",(e,t)=>{po.init(e,t),D.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function j(e,t){return new oc({type:"literal",values:Array.isArray(e)?e:[e],...k(t)})}const ic=m("ZodTransform",(e,t)=>{fo.init(e,t),D.init(e,t),e._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push($e(s,r.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!0),r.issues.push($e(i))}};const a=t.transform(r.value,r);return a instanceof Promise?a.then(s=>(r.value=s,r)):(r.value=a,r)}});function cc(e){return new ic({type:"transform",transform:e})}const xn=m("ZodOptional",(e,t)=>{mo.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType});function sr(e){return new xn({type:"optional",innerType:e})}const uc=m("ZodNullable",(e,t)=>{ho.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType});function or(e){return new uc({type:"nullable",innerType:e})}const lc=m("ZodDefault",(e,t)=>{go.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function pc(e,t){return new lc({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const dc=m("ZodPrefault",(e,t)=>{vo.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType});function fc(e,t){return new dc({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const wn=m("ZodNonOptional",(e,t)=>{yo.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType});function mc(e,t){return new wn({type:"nonoptional",innerType:e,...k(t)})}const hc=m("ZodCatch",(e,t)=>{bo.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function gc(e,t){return new hc({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const vc=m("ZodPipe",(e,t)=>{_o.init(e,t),D.init(e,t),e.in=t.in,e.out=t.out});function ir(e,t){return new vc({type:"pipe",in:e,out:t})}const yc=m("ZodReadonly",(e,t)=>{xo.init(e,t),D.init(e,t)});function bc(e){return new yc({type:"readonly",innerType:e})}const _c=m("ZodLazy",(e,t)=>{wo.init(e,t),D.init(e,t),e.unwrap=()=>e._zod.def.getter()});function xc(e){return new _c({type:"lazy",getter:e})}const $t=m("ZodCustom",(e,t)=>{Eo.init(e,t),D.init(e,t)});function wc(e){const t=new H({check:"custom"});return t._zod.check=e,t}function En(e,t){return mi($t,e??(()=>!0),t)}function Ec(e,t={}){return hi($t,e,t)}function kc(e){const t=wc(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push($e(n,r.value,t._zod.def));else{const a=n;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push($e(a))}},e(r.value,r)));return t}function He(e,t={error:`Input not instance of ${e.name}`}){const r=new $t({type:"custom",check:"custom",fn:n=>n instanceof e,abort:!0,...k(t)});return r._zod.bag.Class=e,r}var Oe=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const a=()=>{const s=r.length,i=new Array(t);for(let o=0;o<t;o++)i[o]=r[Math.random()*s|0];return i.join("")};if(e==null)return a;if(r.includes(n))throw new ga({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return()=>`${e}${n}${a()}`},Ic=Oe();function cr(e=globalThis){var t,r,n;return e.window?"runtime/browser":(t=e.navigator)!=null&&t.userAgent?`runtime/${e.navigator.userAgent.toLowerCase()}`:(n=(r=e.process)==null?void 0:r.versions)!=null&&n.node?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function ue(e){if(e==null)return{};const t={};if(e instanceof Headers)e.forEach((r,n)=>{t[n.toLowerCase()]=r});else{Array.isArray(e)||(e=Object.entries(e));for(const[r,n]of e)n!=null&&(t[r.toLowerCase()]=n)}return t}function ur(e,...t){const r=new Headers(ue(e)),n=r.get("user-agent")||"";return r.set("user-agent",[n,...t].filter(Boolean).join(" ")),Object.fromEntries(r.entries())}var Sc=/"__proto__"\s*:/,Nc=/"constructor"\s*:/;function lr(e){const t=JSON.parse(e);return t===null||typeof t!="object"||Sc.test(e)===!1&&Nc.test(e)===!1?t:Tc(t)}function Tc(e){let t=[e];for(;t.length;){const r=t;t=[];for(const n of r){if(Object.prototype.hasOwnProperty.call(n,"__proto__"))throw new SyntaxError("Object contains forbidden prototype property");if(Object.prototype.hasOwnProperty.call(n,"constructor")&&Object.prototype.hasOwnProperty.call(n.constructor,"prototype"))throw new SyntaxError("Object contains forbidden prototype property");for(const a in n){const s=n[a];s&&typeof s=="object"&&t.push(s)}}}return e}function zc(e){const{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch{return lr(e)}try{return lr(e)}finally{Error.stackTraceLimit=t}}var Ye=Symbol.for("vercel.ai.validator");function jc(e){return{[Ye]:!0,validate:e}}function $c(e){return typeof e=="object"&&e!==null&&Ye in e&&e[Ye]===!0&&"validate"in e}function Ac(e){let t;return()=>(t==null&&(t=e()),t)}function Pc(e){return $c(e)?e:typeof e=="function"?e():Zc(e)}function Zc(e){return jc(async t=>{const r=await e["~standard"].validate(t);return r.issues==null?{success:!0,value:r.value}:{success:!1,error:new Be({value:t,cause:r.issues})}})}async function pr({value:e,schema:t}){const r=await At({value:e,schema:t});if(!r.success)throw Be.wrap({value:e,cause:r.error});return r.value}async function At({value:e,schema:t}){const r=Pc(t);try{if(r.validate==null)return{success:!0,value:e,rawValue:e};const n=await r.validate(e);return n.success?{success:!0,value:n.value,rawValue:e}:{success:!1,error:Be.wrap({value:e,cause:n.error}),rawValue:e}}catch(n){return{success:!1,error:Be.wrap({value:e,cause:n}),rawValue:e}}}async function Xe({text:e,schema:t}){try{const r=zc(e);return t==null?{success:!0,value:r,rawValue:r}:await At({value:r,schema:t})}catch(r){return{success:!1,error:Lt.isInstance(r)?r:new Lt({text:e,cause:r}),rawValue:void 0}}}function Cc({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new wa).pipeThrough(new TransformStream({async transform({data:r},n){r!=="[DONE]"&&n.enqueue(await Xe({text:r,schema:t}))}}))}async function fe(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}function Ue(e){if(e.type==="object"){e.additionalProperties=!1;const t=e.properties;if(t!=null)for(const r in t)t[r]=Ue(t[r])}return e.type==="array"&&e.items!=null&&(Array.isArray(e.items)?e.items=e.items.map(t=>Ue(t)):e.items=Ue(e.items)),e}var Oc=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},Rc=Symbol("Let zodToJsonSchema decide on which parser to use"),dr={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Mc=e=>typeof e=="string"?{...dr,name:e}:{...dr,...e};function Y(){return{}}function Dc(e,t){var r,n,a;const s={type:"array"};return(r=e.type)!=null&&r._def&&((a=(n=e.type)==null?void 0:n._def)==null?void 0:a.typeName)!==z.ZodAny&&(s.items=C(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(s.minItems=e.minLength.value),e.maxLength&&(s.maxItems=e.maxLength.value),e.exactLength&&(s.minItems=e.exactLength.value,s.maxItems=e.exactLength.value),s}function Lc(e){const t={type:"integer",format:"int64"};if(!e.checks)return t;for(const r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value;break}return t}function Fc(){return{type:"boolean"}}function kn(e,t){return C(e.type._def,t)}var Uc=(e,t)=>C(e.innerType._def,t);function In(e,t,r){const n=r??t.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,s)=>In(e,t,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Vc(e)}}var Vc=e=>{const t={type:"integer",format:"unix-time"};for(const r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value;break}return t};function Wc(e,t){return{...C(e.innerType._def,t),default:e.defaultValue()}}function Jc(e,t){return t.effectStrategy==="input"?C(e.schema._def,t):Y()}function Bc(e){return{type:"string",enum:Array.from(e.values)}}var qc=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Gc(e,t){const r=[C(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),C(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(a=>!!a),n=[];return r.forEach(a=>{if(qc(a))n.push(...a.allOf);else{let s=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:i,...o}=a;s=o}n.push(s)}}),n.length?{allOf:n}:void 0}function Kc(e){const t=typeof e.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(e.value)?"array":"object"}:{type:t==="bigint"?"integer":t,const:e.value}}var ut=void 0,ee={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ut===void 0&&(ut=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ut),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Sn(e,t){const r={type:"string"};if(e.checks)for(const n of e.checks)switch(n.kind){case"min":r.minLength=typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value;break;case"max":r.maxLength=typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value;break;case"email":switch(t.emailStrategy){case"format:email":te(r,"email",n.message,t);break;case"format:idn-email":te(r,"idn-email",n.message,t);break;case"pattern:zod":q(r,ee.email,n.message,t);break}break;case"url":te(r,"uri",n.message,t);break;case"uuid":te(r,"uuid",n.message,t);break;case"regex":q(r,n.regex,n.message,t);break;case"cuid":q(r,ee.cuid,n.message,t);break;case"cuid2":q(r,ee.cuid2,n.message,t);break;case"startsWith":q(r,RegExp(`^${lt(n.value,t)}`),n.message,t);break;case"endsWith":q(r,RegExp(`${lt(n.value,t)}$`),n.message,t);break;case"datetime":te(r,"date-time",n.message,t);break;case"date":te(r,"date",n.message,t);break;case"time":te(r,"time",n.message,t);break;case"duration":te(r,"duration",n.message,t);break;case"length":r.minLength=typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,r.maxLength=typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value;break;case"includes":{q(r,RegExp(lt(n.value,t)),n.message,t);break}case"ip":{n.version!=="v6"&&te(r,"ipv4",n.message,t),n.version!=="v4"&&te(r,"ipv6",n.message,t);break}case"base64url":q(r,ee.base64url,n.message,t);break;case"jwt":q(r,ee.jwt,n.message,t);break;case"cidr":{n.version!=="v6"&&q(r,ee.ipv4Cidr,n.message,t),n.version!=="v4"&&q(r,ee.ipv6Cidr,n.message,t);break}case"emoji":q(r,ee.emoji(),n.message,t);break;case"ulid":{q(r,ee.ulid,n.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{te(r,"binary",n.message,t);break}case"contentEncoding:base64":{r.contentEncoding="base64";break}case"pattern:zod":{q(r,ee.base64,n.message,t);break}}break}case"nanoid":q(r,ee.nanoid,n.message,t)}return r}function lt(e,t){return t.patternStrategy==="escape"?Yc(e):e}var Hc=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Yc(e){let t="";for(let r=0;r<e.length;r++)Hc.has(e[r])||(t+="\\"),t+=e[r];return t}function te(e,t,r,n){var a;e.format||(a=e.anyOf)!=null&&a.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function q(e,t,r,n){var a;e.pattern||(a=e.allOf)!=null&&a.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:fr(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=fr(t,n)}function fr(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},a=n.i?e.source.toLowerCase():e.source;let s="",i=!1,o=!1,u=!1;for(let c=0;c<a.length;c++){if(i){s+=a[c],i=!1;continue}if(n.i){if(o){if(a[c].match(/[a-z]/)){u?(s+=a[c],s+=`${a[c-2]}-${a[c]}`.toUpperCase(),u=!1):a[c+1]==="-"&&((r=a[c+2])!=null&&r.match(/[a-z]/))?(s+=a[c],u=!0):s+=`${a[c]}${a[c].toUpperCase()}`;continue}}else if(a[c].match(/[a-z]/)){s+=`[${a[c]}${a[c].toUpperCase()}]`;continue}}if(n.m){if(a[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(a[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&a[c]==="."){s+=o?`${a[c]}\r
`:`[${a[c]}\r
]`;continue}s+=a[c],a[c]==="\\"?i=!0:o&&a[c]==="]"?o=!1:!o&&a[c]==="["&&(o=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function Nn(e,t){var r,n,a,s,i,o;const u={type:"object",additionalProperties:(r=C(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))!=null?r:t.allowedAdditionalProperties};if(((n=e.keyType)==null?void 0:n._def.typeName)===z.ZodString&&((a=e.keyType._def.checks)!=null&&a.length)){const{type:c,...p}=Sn(e.keyType._def,t);return{...u,propertyNames:p}}else{if(((s=e.keyType)==null?void 0:s._def.typeName)===z.ZodEnum)return{...u,propertyNames:{enum:e.keyType._def.values}};if(((i=e.keyType)==null?void 0:i._def.typeName)===z.ZodBranded&&e.keyType._def.type._def.typeName===z.ZodString&&((o=e.keyType._def.type._def.checks)!=null&&o.length)){const{type:c,...p}=kn(e.keyType._def,t);return{...u,propertyNames:p}}}return u}function Xc(e,t){if(t.mapStrategy==="record")return Nn(e,t);const r=C(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||Y(),n=C(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||Y();return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function Qc(e){const t=e.values,n=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),a=Array.from(new Set(n.map(s=>typeof s)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:n}}function eu(){return{not:Y()}}function tu(){return{type:"null"}}var _t={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function ru(e,t){const r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(n=>n._def.typeName in _t&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((a,s)=>{const i=_t[s._def.typeName];return i&&!a.includes(i)?[...a,i]:a},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((a,s)=>{const i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...a,i];case"bigint":return[...a,"integer"];case"object":if(s._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(n.length===r.length){const a=n.filter((s,i,o)=>o.indexOf(s)===i);return{type:a.length>1?a:a[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,a)=>[...n,...a._def.values.filter(s=>!n.includes(s))],[])};return nu(e,t)}var nu=(e,t)=>{const r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((n,a)=>C(n._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(n=>!!n&&(!t.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function au(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[_t[e.innerType._def.typeName],"null"]};const r=C(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function su(e){const t={type:"number"};if(!e.checks)return t;for(const r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value;break}return t}function ou(e,t){const r={type:"object",properties:{}},n=[],a=e.shape();for(const i in a){let o=a[i];if(o===void 0||o._def===void 0)continue;const u=cu(o),c=C(o._def,{...t,currentPath:[...t.currentPath,"properties",i],propertyPath:[...t.currentPath,"properties",i]});c!==void 0&&(r.properties[i]=c,u||n.push(i))}n.length&&(r.required=n);const s=iu(e,t);return s!==void 0&&(r.additionalProperties=s),r}function iu(e,t){if(e.catchall._def.typeName!=="ZodNever")return C(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function cu(e){try{return e.isOptional()}catch{return!0}}var uu=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return C(e.innerType._def,t);const n=C(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:Y()},n]}:Y()},lu=(e,t)=>{if(t.pipeStrategy==="input")return C(e.in._def,t);if(t.pipeStrategy==="output")return C(e.out._def,t);const r=C(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=C(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(a=>a!==void 0)}};function pu(e,t){return C(e.type._def,t)}function du(e,t){const n={type:"array",uniqueItems:!0,items:C(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(n.minItems=e.minSize.value),e.maxSize&&(n.maxItems=e.maxSize.value),n}function fu(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((r,n)=>C(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:C(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((r,n)=>C(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function mu(){return{not:Y()}}function hu(){return Y()}var gu=(e,t)=>C(e.innerType._def,t),vu=(e,t,r)=>{switch(t){case z.ZodString:return Sn(e,r);case z.ZodNumber:return su(e);case z.ZodObject:return ou(e,r);case z.ZodBigInt:return Lc(e);case z.ZodBoolean:return Fc();case z.ZodDate:return In(e,r);case z.ZodUndefined:return mu();case z.ZodNull:return tu();case z.ZodArray:return Dc(e,r);case z.ZodUnion:case z.ZodDiscriminatedUnion:return ru(e,r);case z.ZodIntersection:return Gc(e,r);case z.ZodTuple:return fu(e,r);case z.ZodRecord:return Nn(e,r);case z.ZodLiteral:return Kc(e);case z.ZodEnum:return Bc(e);case z.ZodNativeEnum:return Qc(e);case z.ZodNullable:return au(e,r);case z.ZodOptional:return uu(e,r);case z.ZodMap:return Xc(e,r);case z.ZodSet:return du(e,r);case z.ZodLazy:return()=>e.getter()._def;case z.ZodPromise:return pu(e,r);case z.ZodNaN:case z.ZodNever:return eu();case z.ZodEffects:return Jc(e,r);case z.ZodAny:return Y();case z.ZodUnknown:return hu();case z.ZodDefault:return Wc(e,r);case z.ZodBranded:return kn(e,r);case z.ZodReadonly:return gu(e,r);case z.ZodCatch:return Uc(e,r);case z.ZodPipeline:return lu(e,r);case z.ZodFunction:case z.ZodVoid:case z.ZodSymbol:return;default:return(n=>{})()}};function C(e,t,r=!1){var n;const a=t.seen.get(e);if(t.override){const u=(n=t.override)==null?void 0:n.call(t,e,t,a,r);if(u!==Rc)return u}if(a&&!r){const u=yu(a,t);if(u!==void 0)return u}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=vu(e,e.typeName,t),o=typeof i=="function"?C(i(),t):i;if(o&&bu(e,t,o),t.postProcess){const u=t.postProcess(o,e,t);return s.jsonSchema=o,u}return s.jsonSchema=o,o}var yu=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Oc(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,n)=>t.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),Y()):t.$refStrategy==="seen"?Y():void 0}},bu=(e,t,r)=>(e.description&&(r.description=e.description),r),_u=e=>{const t=Mc(e),r=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([n,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]))}},xu=(e,t)=>{var r;const n=_u(t);let a=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((c,[p,l])=>{var b;return{...c,[p]:(b=C(l._def,{...n,currentPath:[...n.basePath,n.definitionPath,p]},!0))!=null?b:Y()}},{}):void 0;const s=typeof t=="string"?t:t?.nameStrategy==="title"?void 0:t?.name,i=(r=C(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1))!=null?r:Y(),o=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;o!==void 0&&(i.title=o);const u=s===void 0?a?{...i,[n.definitionPath]:a}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...a,[s]:i}};return u.$schema="http://json-schema.org/draft-07/schema#",u},wu=xu;function Eu(e,t){var r;const n=(r=void 0)!=null?r:!1;return Pt(()=>wu(e,{$refStrategy:n?"root":"none"}),{validate:async a=>{const s=await e.safeParseAsync(a);return s.success?{success:!0,value:s.data}:{success:!1,error:s.error}}})}function ku(e,t){var r;const n=(r=void 0)!=null?r:!1;return Pt(()=>Ue(gi(e,{target:"draft-7",io:"input",reused:n?"ref":"inline"})),{validate:async a=>{const s=await mn(e,a);return s.success?{success:!0,value:s.data}:{success:!1,error:s.error}}})}function Iu(e){return"_zod"in e}function Tn(e,t){return Iu(e)?ku(e):Eu(e)}var xt=Symbol.for("vercel.ai.schema");function Pt(e,{validate:t}={}){return{[xt]:!0,_type:void 0,[Ye]:!0,get jsonSchema(){return typeof e=="function"&&(e=e()),e},validate:t}}function Su(e){return typeof e=="object"&&e!==null&&xt in e&&e[xt]===!0&&"jsonSchema"in e&&"validate"in e}function Nu(e){return e==null?Pt({properties:{},additionalProperties:!1}):Su(e)?e:typeof e=="function"?e():Tn(e)}var Tu=Object.defineProperty,zu=(e,t)=>{for(var r in t)Tu(e,r,{get:t[r],enumerable:!0})},zn="AI_NoObjectGeneratedError",jn=`vercel.ai.error.${zn}`,ju=Symbol.for(jn),$n,mr=class extends se{constructor({message:e="No object generated.",cause:t,text:r,response:n,usage:a,finishReason:s}){super({name:zn,message:e,cause:t}),this[$n]=!0,this.text=r,this.response=n,this.usage=a,this.finishReason=s}static isInstance(e){return se.hasMarker(e,jn)}};$n=ju;var hr="5.0.114",An=Q([I(),He(Uint8Array),He(ArrayBuffer),En(e=>{var t,r;return(r=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?r:!1},{message:"Must be a Buffer"})]),Ae=xc(()=>Q([Yi(),I(),qi(),K(),yt(I(),Ae),ve(Ae)])),V=yt(I(),yt(I(),Ae)),Pn=B({type:j("text"),text:I(),providerOptions:V.optional()}),$u=B({type:j("image"),image:Q([An,He(URL)]),mediaType:I().optional(),providerOptions:V.optional()}),Zn=B({type:j("file"),data:Q([An,He(URL)]),filename:I().optional(),mediaType:I(),providerOptions:V.optional()}),Au=B({type:j("reasoning"),text:I(),providerOptions:V.optional()}),Pu=B({type:j("tool-call"),toolCallId:I(),toolName:I(),input:ne(),providerOptions:V.optional(),providerExecuted:K().optional()}),Zu=rc("type",[B({type:j("text"),value:I()}),B({type:j("json"),value:Ae}),B({type:j("error-text"),value:I()}),B({type:j("error-json"),value:Ae}),B({type:j("content"),value:ve(Q([B({type:j("text"),text:I()}),B({type:j("media"),data:I(),mediaType:I()})]))})]),Cn=B({type:j("tool-result"),toolCallId:I(),toolName:I(),output:Zu,providerOptions:V.optional()}),Cu=B({role:j("system"),content:I(),providerOptions:V.optional()}),Ou=B({role:j("user"),content:Q([I(),ve(Q([Pn,$u,Zn]))]),providerOptions:V.optional()}),Ru=B({role:j("assistant"),content:Q([I(),ve(Q([Pn,Zn,Au,Pu,Cn]))]),providerOptions:V.optional()}),Mu=B({role:j("tool"),content:ve(Cn),providerOptions:V.optional()});Q([Cu,Ou,Ru,Mu]);Oe({prefix:"aitxt",size:24});(class extends TransformStream{constructor(){super({transform(e,t){t.enqueue(`data: ${JSON.stringify(e)}

`)},flush(e){e.enqueue(`data: [DONE]

`)}})}});var Du=Ac(()=>Tn(Q([L({type:j("text-start"),id:I(),providerMetadata:V.optional()}),L({type:j("text-delta"),id:I(),delta:I(),providerMetadata:V.optional()}),L({type:j("text-end"),id:I(),providerMetadata:V.optional()}),L({type:j("error"),errorText:I()}),L({type:j("tool-input-start"),toolCallId:I(),toolName:I(),providerExecuted:K().optional(),dynamic:K().optional()}),L({type:j("tool-input-delta"),toolCallId:I(),inputTextDelta:I()}),L({type:j("tool-input-available"),toolCallId:I(),toolName:I(),input:ne(),providerExecuted:K().optional(),providerMetadata:V.optional(),dynamic:K().optional()}),L({type:j("tool-input-error"),toolCallId:I(),toolName:I(),input:ne(),providerExecuted:K().optional(),providerMetadata:V.optional(),dynamic:K().optional(),errorText:I()}),L({type:j("tool-output-available"),toolCallId:I(),output:ne(),providerExecuted:K().optional(),dynamic:K().optional(),preliminary:K().optional()}),L({type:j("tool-output-error"),toolCallId:I(),errorText:I(),providerExecuted:K().optional(),dynamic:K().optional()}),L({type:j("reasoning-start"),id:I(),providerMetadata:V.optional()}),L({type:j("reasoning-delta"),id:I(),delta:I(),providerMetadata:V.optional()}),L({type:j("reasoning-end"),id:I(),providerMetadata:V.optional()}),L({type:j("source-url"),sourceId:I(),url:I(),title:I().optional(),providerMetadata:V.optional()}),L({type:j("source-document"),sourceId:I(),mediaType:I(),title:I(),filename:I().optional(),providerMetadata:V.optional()}),L({type:j("file"),url:I(),mediaType:I(),providerMetadata:V.optional()}),L({type:En(e=>typeof e=="string"&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:I().optional(),data:ne(),transient:K().optional()}),L({type:j("start-step")}),L({type:j("finish-step")}),L({type:j("start"),messageId:I().optional(),messageMetadata:ne().optional()}),L({type:j("finish"),finishReason:_n(["stop","length","content-filter","tool-calls","error","other","unknown"]).optional(),messageMetadata:ne().optional()}),L({type:j("abort")}),L({type:j("message-metadata"),messageMetadata:ne()})])));function Lu(e){return e.type.startsWith("data-")}function On(e,t){if(e===void 0&&t===void 0)return;if(e===void 0)return t;if(t===void 0)return e;const r={...e};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const a=t[n];if(a===void 0)continue;const s=n in e?e[n]:void 0,i=a!==null&&typeof a=="object"&&!Array.isArray(a)&&!(a instanceof Date)&&!(a instanceof RegExp),o=s!=null&&typeof s=="object"&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp);i&&o?r[n]=On(s,a):r[n]=a}return r}function Fu(e){const t=["ROOT"];let r=-1,n=null;function a(u,c,p){switch(u){case'"':{r=c,t.pop(),t.push(p),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{r=c,n=c,t.pop(),t.push(p),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(p),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=c,t.pop(),t.push(p),t.push("INSIDE_NUMBER");break}case"{":{r=c,t.pop(),t.push(p),t.push("INSIDE_OBJECT_START");break}case"[":{r=c,t.pop(),t.push(p),t.push("INSIDE_ARRAY_START");break}}}function s(u,c){switch(u){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{r=c,t.pop();break}}}function i(u,c){switch(u){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=c,t.pop();break}}}for(let u=0;u<e.length;u++){const c=e[u];switch(t[t.length-1]){case"ROOT":a(c,u,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{r=u,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(c,u,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{s(c,u);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),r=u;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:r=u}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{r=u,t.pop();break}default:{r=u,a(c,u,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=u,t.pop();break}default:{r=u;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(c,u,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),r=u;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=u;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(c,u),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(c,u);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(c,u);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(c,u);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const l=e.substring(n,u+1);!"false".startsWith(l)&&!"true".startsWith(l)&&!"null".startsWith(l)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?s(c,u):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&i(c,u)):r=u;break}}}let o=e.slice(0,r+1);for(let u=t.length-1;u>=0;u--)switch(t[u]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const p=e.substring(n,e.length);"true".startsWith(p)?o+="true".slice(p.length):"false".startsWith(p)?o+="false".slice(p.length):"null".startsWith(p)&&(o+="null".slice(p.length))}}return o}async function Rn(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=await Xe({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await Xe({text:Fu(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}function Ve(e){return e.type.startsWith("tool-")}function Uu(e){return e.type==="dynamic-tool"}function wt(e){return Ve(e)||Uu(e)}function gr(e){return e.type.split("-").slice(1).join("-")}function Vu({lastMessage:e,messageId:t}){return{message:e?.role==="assistant"?e:{id:t,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}function Wu({stream:e,messageMetadataSchema:t,dataPartSchemas:r,runUpdateMessageJob:n,onError:a,onToolCall:s,onData:i}){return e.pipeThrough(new TransformStream({async transform(o,u){await n(async({state:c,write:p})=>{var l,b,v,f;function h(g){const A=c.message.parts.filter(Ve).find(T=>T.toolCallId===g);if(A==null)throw new Error("tool-output-error must be preceded by a tool-input-available");return A}function y(g){const A=c.message.parts.filter(T=>T.type==="dynamic-tool").find(T=>T.toolCallId===g);if(A==null)throw new Error("tool-output-error must be preceded by a tool-input-available");return A}function w(g){var $;const A=c.message.parts.find(J=>Ve(J)&&J.toolCallId===g.toolCallId),T=g,N=A;A!=null?(A.state=g.state,N.input=T.input,N.output=T.output,N.errorText=T.errorText,N.rawInput=T.rawInput,N.preliminary=T.preliminary,N.providerExecuted=($=T.providerExecuted)!=null?$:A.providerExecuted,T.providerMetadata!=null&&A.state==="input-available"&&(A.callProviderMetadata=T.providerMetadata)):c.message.parts.push({type:`tool-${g.toolName}`,toolCallId:g.toolCallId,state:g.state,input:T.input,output:T.output,rawInput:T.rawInput,errorText:T.errorText,providerExecuted:T.providerExecuted,preliminary:T.preliminary,...T.providerMetadata!=null?{callProviderMetadata:T.providerMetadata}:{}})}function x(g){var $,A;const T=c.message.parts.find(G=>G.type==="dynamic-tool"&&G.toolCallId===g.toolCallId),N=g,J=T;T!=null?(T.state=g.state,J.toolName=g.toolName,J.input=N.input,J.output=N.output,J.errorText=N.errorText,J.rawInput=($=N.rawInput)!=null?$:J.rawInput,J.preliminary=N.preliminary,J.providerExecuted=(A=N.providerExecuted)!=null?A:T.providerExecuted,N.providerMetadata!=null&&T.state==="input-available"&&(T.callProviderMetadata=N.providerMetadata)):c.message.parts.push({type:"dynamic-tool",toolName:g.toolName,toolCallId:g.toolCallId,state:g.state,input:N.input,output:N.output,errorText:N.errorText,preliminary:N.preliminary,providerExecuted:N.providerExecuted,...N.providerMetadata!=null?{callProviderMetadata:N.providerMetadata}:{}})}async function E(g){if(g!=null){const $=c.message.metadata!=null?On(c.message.metadata,g):g;t!=null&&await pr({value:$,schema:t}),c.message.metadata=$}}switch(o.type){case"text-start":{const g={type:"text",text:"",providerMetadata:o.providerMetadata,state:"streaming"};c.activeTextParts[o.id]=g,c.message.parts.push(g),p();break}case"text-delta":{const g=c.activeTextParts[o.id];g.text+=o.delta,g.providerMetadata=(l=o.providerMetadata)!=null?l:g.providerMetadata,p();break}case"text-end":{const g=c.activeTextParts[o.id];g.state="done",g.providerMetadata=(b=o.providerMetadata)!=null?b:g.providerMetadata,delete c.activeTextParts[o.id],p();break}case"reasoning-start":{const g={type:"reasoning",text:"",providerMetadata:o.providerMetadata,state:"streaming"};c.activeReasoningParts[o.id]=g,c.message.parts.push(g),p();break}case"reasoning-delta":{const g=c.activeReasoningParts[o.id];g.text+=o.delta,g.providerMetadata=(v=o.providerMetadata)!=null?v:g.providerMetadata,p();break}case"reasoning-end":{const g=c.activeReasoningParts[o.id];g.providerMetadata=(f=o.providerMetadata)!=null?f:g.providerMetadata,g.state="done",delete c.activeReasoningParts[o.id],p();break}case"file":{c.message.parts.push({type:"file",mediaType:o.mediaType,url:o.url}),p();break}case"source-url":{c.message.parts.push({type:"source-url",sourceId:o.sourceId,url:o.url,title:o.title,providerMetadata:o.providerMetadata}),p();break}case"source-document":{c.message.parts.push({type:"source-document",sourceId:o.sourceId,mediaType:o.mediaType,title:o.title,filename:o.filename,providerMetadata:o.providerMetadata}),p();break}case"tool-input-start":{const g=c.message.parts.filter(Ve);c.partialToolCalls[o.toolCallId]={text:"",toolName:o.toolName,index:g.length,dynamic:o.dynamic},o.dynamic?x({toolCallId:o.toolCallId,toolName:o.toolName,state:"input-streaming",input:void 0,providerExecuted:o.providerExecuted}):w({toolCallId:o.toolCallId,toolName:o.toolName,state:"input-streaming",input:void 0,providerExecuted:o.providerExecuted}),p();break}case"tool-input-delta":{const g=c.partialToolCalls[o.toolCallId];g.text+=o.inputTextDelta;const{value:$}=await Rn(g.text);g.dynamic?x({toolCallId:o.toolCallId,toolName:g.toolName,state:"input-streaming",input:$}):w({toolCallId:o.toolCallId,toolName:g.toolName,state:"input-streaming",input:$}),p();break}case"tool-input-available":{o.dynamic?x({toolCallId:o.toolCallId,toolName:o.toolName,state:"input-available",input:o.input,providerExecuted:o.providerExecuted,providerMetadata:o.providerMetadata}):w({toolCallId:o.toolCallId,toolName:o.toolName,state:"input-available",input:o.input,providerExecuted:o.providerExecuted,providerMetadata:o.providerMetadata}),p(),s&&!o.providerExecuted&&await s({toolCall:o});break}case"tool-input-error":{o.dynamic?x({toolCallId:o.toolCallId,toolName:o.toolName,state:"output-error",input:o.input,errorText:o.errorText,providerExecuted:o.providerExecuted,providerMetadata:o.providerMetadata}):w({toolCallId:o.toolCallId,toolName:o.toolName,state:"output-error",input:void 0,rawInput:o.input,errorText:o.errorText,providerExecuted:o.providerExecuted,providerMetadata:o.providerMetadata}),p();break}case"tool-output-available":{if(o.dynamic){const g=y(o.toolCallId);x({toolCallId:o.toolCallId,toolName:g.toolName,state:"output-available",input:g.input,output:o.output,preliminary:o.preliminary})}else{const g=h(o.toolCallId);w({toolCallId:o.toolCallId,toolName:gr(g),state:"output-available",input:g.input,output:o.output,providerExecuted:o.providerExecuted,preliminary:o.preliminary})}p();break}case"tool-output-error":{if(o.dynamic){const g=y(o.toolCallId);x({toolCallId:o.toolCallId,toolName:g.toolName,state:"output-error",input:g.input,errorText:o.errorText,providerExecuted:o.providerExecuted})}else{const g=h(o.toolCallId);w({toolCallId:o.toolCallId,toolName:gr(g),state:"output-error",input:g.input,rawInput:g.rawInput,errorText:o.errorText,providerExecuted:o.providerExecuted})}p();break}case"start-step":{c.message.parts.push({type:"step-start"});break}case"finish-step":{c.activeTextParts={},c.activeReasoningParts={};break}case"start":{o.messageId!=null&&(c.message.id=o.messageId),await E(o.messageMetadata),(o.messageId!=null||o.messageMetadata!=null)&&p();break}case"finish":{o.finishReason!=null&&(c.finishReason=o.finishReason),await E(o.messageMetadata),o.messageMetadata!=null&&p();break}case"message-metadata":{await E(o.messageMetadata),o.messageMetadata!=null&&p();break}case"error":{a?.(new Error(o.errorText));break}default:if(Lu(o)){r?.[o.type]!=null&&await pr({value:o.data,schema:r[o.type]});const g=o;if(g.transient){i?.(g);break}const $=g.id!=null?c.message.parts.find(A=>g.type===A.type&&g.id===A.id):void 0;$!=null?$.data=g.data:c.message.parts.push(g),i?.(g),p()}}u.enqueue(o)})}}))}async function Ju({stream:e,onError:t}){const r=e.getReader();try{for(;;){const{done:n}=await r.read();if(n)break}}catch(n){t?.(n)}finally{r.releaseLock()}}Oe({prefix:"aitxt",size:24});Oe({prefix:"aiobj",size:24});var Bu=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(e){return new Promise((t,r)=>{this.queue.push(async()=>{try{await e(),t()}catch(n){r(n)}}),this.processQueue()})}};Oe({prefix:"aiobj",size:24});var qu={};zu(qu,{object:()=>Ku,text:()=>Gu});var Gu=()=>({type:"text",responseFormat:{type:"text"},async parsePartial({text:e}){return{partial:e}},async parseOutput({text:e}){return e}}),Ku=({schema:e})=>{const t=Nu(e);return{type:"object",responseFormat:{type:"json",schema:t.jsonSchema},async parsePartial({text:r}){const n=await Rn(r);switch(n.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:n.value};default:{const a=n.state;throw new Error(`Unsupported parse state: ${a}`)}}},async parseOutput({text:r},n){const a=await Xe({text:r});if(!a.success)throw new mr({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});const s=await At({value:a.value,schema:t});if(!s.success)throw new mr({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});return s.value}}};async function Hu(e){if(e==null)return[];if(!globalThis.FileList||!(e instanceof globalThis.FileList))throw new Error("FileList is not supported in the current environment");return Promise.all(Array.from(e).map(async t=>{const{name:r,type:n}=t,a=await new Promise((s,i)=>{const o=new FileReader;o.onload=u=>{var c;s((c=u.target)==null?void 0:c.result)},o.onerror=u=>i(u),o.readAsDataURL(t)});return{type:"file",mediaType:n,filename:r,url:a}}))}var Yu=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:n,fetch:a,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=r,this.body=n,this.fetch=a,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=i}async sendMessages({abortSignal:e,...t}){var r,n,a,s,i;const o=await fe(this.body),u=await fe(this.headers),c=await fe(this.credentials),p={...ue(u),...ue(t.headers)},l=await((r=this.prepareSendMessagesRequest)==null?void 0:r.call(this,{api:this.api,id:t.chatId,messages:t.messages,body:{...o,...t.body},headers:p,credentials:c,requestMetadata:t.metadata,trigger:t.trigger,messageId:t.messageId})),b=(n=l?.api)!=null?n:this.api,v=l?.headers!==void 0?ue(l.headers):p,f=l?.body!==void 0?l.body:{...o,...t.body,id:t.chatId,messages:t.messages,trigger:t.trigger,messageId:t.messageId},h=(a=l?.credentials)!=null?a:c,w=await((s=this.fetch)!=null?s:globalThis.fetch)(b,{method:"POST",headers:ur({"Content-Type":"application/json",...v},`ai-sdk/${hr}`,cr()),body:JSON.stringify(f),credentials:h,signal:e});if(!w.ok)throw new Error((i=await w.text())!=null?i:"Failed to fetch the chat response.");if(!w.body)throw new Error("The response body is empty.");return this.processResponseStream(w.body)}async reconnectToStream(e){var t,r,n,a,s;const i=await fe(this.body),o=await fe(this.headers),u=await fe(this.credentials),c={...ue(o),...ue(e.headers)},p=await((t=this.prepareReconnectToStreamRequest)==null?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:c,credentials:u,requestMetadata:e.metadata})),l=(r=p?.api)!=null?r:`${this.api}/${e.chatId}/stream`,b=p?.headers!==void 0?ue(p.headers):c,v=(n=p?.credentials)!=null?n:u,h=await((a=this.fetch)!=null?a:globalThis.fetch)(l,{method:"GET",headers:ur(b,`ai-sdk/${hr}`,cr()),credentials:v});if(h.status===204)return null;if(!h.ok)throw new Error((s=await h.text())!=null?s:"Failed to fetch the chat response.");if(!h.body)throw new Error("The response body is empty.");return this.processResponseStream(h.body)}},Xu=class extends Yu{constructor(e={}){super(e)}processResponseStream(e){return Cc({stream:e,schema:Du}).pipeThrough(new TransformStream({async transform(t,r){if(!t.success)throw t.error;r.enqueue(t.value)}}))}},Qu=class{constructor({generateId:e=Ic,id:t=e(),transport:r=new Xu,messageMetadataSchema:n,dataPartSchemas:a,state:s,onError:i,onToolCall:o,onFinish:u,onData:c,sendAutomaticallyWhen:p}){this.activeResponse=void 0,this.jobExecutor=new Bu,this.sendMessage=async(l,b)=>{var v,f,h,y;if(l==null){await this.makeRequest({trigger:"submit-message",messageId:(v=this.lastMessage)==null?void 0:v.id,...b});return}let w;if("text"in l||"files"in l?w={parts:[...Array.isArray(l.files)?l.files:await Hu(l.files),..."text"in l&&l.text!=null?[{type:"text",text:l.text}]:[]]}:w=l,l.messageId!=null){const x=this.state.messages.findIndex(E=>E.id===l.messageId);if(x===-1)throw new Error(`message with id ${l.messageId} not found`);if(this.state.messages[x].role!=="user")throw new Error(`message with id ${l.messageId} is not a user message`);this.state.messages=this.state.messages.slice(0,x+1),this.state.replaceMessage(x,{...w,id:l.messageId,role:(f=w.role)!=null?f:"user",metadata:l.metadata})}else this.state.pushMessage({...w,id:(h=w.id)!=null?h:this.generateId(),role:(y=w.role)!=null?y:"user",metadata:l.metadata});await this.makeRequest({trigger:"submit-message",messageId:l.messageId,...b})},this.regenerate=async({messageId:l,...b}={})=>{const v=l==null?this.state.messages.length-1:this.state.messages.findIndex(f=>f.id===l);if(v===-1)throw new Error(`message ${l} not found`);this.state.messages=this.state.messages.slice(0,this.messages[v].role==="assistant"?v:v+1),await this.makeRequest({trigger:"regenerate-message",messageId:l,...b})},this.resumeStream=async(l={})=>{await this.makeRequest({trigger:"resume-stream",...l})},this.clearError=()=>{this.status==="error"&&(this.state.error=void 0,this.setStatus({status:"ready"}))},this.addToolOutput=async({state:l="output-available",tool:b,toolCallId:v,output:f,errorText:h})=>this.jobExecutor.run(async()=>{var y,w;const x=this.state.messages,E=x[x.length-1];this.state.replaceMessage(x.length-1,{...E,parts:E.parts.map(g=>wt(g)&&g.toolCallId===v?{...g,state:l,output:f,errorText:h}:g)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(g=>wt(g)&&g.toolCallId===v?{...g,state:l,output:f,errorText:h}:g)),this.status!=="streaming"&&this.status!=="submitted"&&((y=this.sendAutomaticallyWhen)!=null&&y.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:(w=this.lastMessage)==null?void 0:w.id})}),this.addToolResult=this.addToolOutput,this.stop=async()=>{var l;this.status!=="streaming"&&this.status!=="submitted"||(l=this.activeResponse)!=null&&l.abortController&&this.activeResponse.abortController.abort()},this.id=t,this.transport=r,this.generateId=e,this.messageMetadataSchema=n,this.dataPartSchemas=a,this.state=s,this.onError=i,this.onToolCall=o,this.onFinish=u,this.onData=c,this.sendAutomaticallyWhen=p}get status(){return this.state.status}setStatus({status:e,error:t}){this.status!==e&&(this.state.status=e,this.state.error=t)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(e){this.state.messages=e}async makeRequest({trigger:e,metadata:t,headers:r,body:n,messageId:a}){var s,i,o,u;this.setStatus({status:"submitted",error:void 0});const c=this.lastMessage;let p=!1,l=!1,b=!1;try{const v={state:Vu({lastMessage:this.state.snapshot(c),messageId:this.generateId()}),abortController:new AbortController};v.abortController.signal.addEventListener("abort",()=>{p=!0}),this.activeResponse=v;let f;if(e==="resume-stream"){const y=await this.transport.reconnectToStream({chatId:this.id,metadata:t,headers:r,body:n});if(y==null){this.setStatus({status:"ready"});return}f=y}else f=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:v.abortController.signal,metadata:t,headers:r,body:n,trigger:e,messageId:a});const h=y=>this.jobExecutor.run(()=>y({state:v.state,write:()=>{var w;this.setStatus({status:"streaming"}),v.state.message.id===((w=this.lastMessage)==null?void 0:w.id)?this.state.replaceMessage(this.state.messages.length-1,v.state.message):this.state.pushMessage(v.state.message)}}));await Ju({stream:Wu({stream:f,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:h,onError:y=>{throw y}}),onError:y=>{throw y}}),this.setStatus({status:"ready"})}catch(v){if(p||v.name==="AbortError")return p=!0,this.setStatus({status:"ready"}),null;b=!0,v instanceof TypeError&&(v.message.toLowerCase().includes("fetch")||v.message.toLowerCase().includes("network"))&&(l=!0),this.onError&&v instanceof Error&&this.onError(v),this.setStatus({status:"error",error:v})}finally{try{(i=this.onFinish)==null||i.call(this,{message:this.activeResponse.state.message,messages:this.state.messages,isAbort:p,isDisconnect:l,isError:b,finishReason:(s=this.activeResponse)==null?void 0:s.state.finishReason})}catch(v){console.error(v)}this.activeResponse=void 0}(o=this.sendAutomaticallyWhen)!=null&&o.call(this,{messages:this.state.messages})&&!b&&await this.makeRequest({trigger:"submit-message",messageId:(u=this.lastMessage)==null?void 0:u.id,metadata:t,headers:r,body:n})}};function el({messages:e}){const t=e[e.length-1];if(!t||t.role!=="assistant")return!1;const r=t.parts.reduce((a,s,i)=>s.type==="step-start"?i:a,-1),n=t.parts.slice(r+1).filter(wt).filter(a=>!a.providerExecuted);return n.length>0&&n.every(a=>a.state==="output-available"||a.state==="output-error")}var pt,vr;function tl(){if(vr)return pt;vr=1;function e(t,r){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let n,a=0;return function(...i){clearTimeout(n);const o=Date.now(),u=o-a,c=r-u;c<=0?(a=o,t.apply(this,i)):n=setTimeout(()=>{a=Date.now(),t.apply(this,i)},c)}}return pt=e,pt}var rl=tl();const nl=Pr(rl);var Mn=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},R=(e,t,r)=>(Mn(e,t,"read from private field"),r?r.call(e):t.get(e)),re=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},ae=(e,t,r,n)=>(Mn(e,t,"write to private field"),t.set(e,r),r);function al(e,t){return t!=null?nl(e,t):e}var X,We,Je,Se,Ne,Te,he,Et,kt,sl=class{constructor(e=[]){re(this,X,void 0),re(this,We,"ready"),re(this,Je,void 0),re(this,Se,new Set),re(this,Ne,new Set),re(this,Te,new Set),this.pushMessage=t=>{ae(this,X,R(this,X).concat(t)),R(this,he).call(this)},this.popMessage=()=>{ae(this,X,R(this,X).slice(0,-1)),R(this,he).call(this)},this.replaceMessage=(t,r)=>{ae(this,X,[...R(this,X).slice(0,t),this.snapshot(r),...R(this,X).slice(t+1)]),R(this,he).call(this)},this.snapshot=t=>structuredClone(t),this["~registerMessagesCallback"]=(t,r)=>{const n=r?al(t,r):t;return R(this,Se).add(n),()=>{R(this,Se).delete(n)}},this["~registerStatusCallback"]=t=>(R(this,Ne).add(t),()=>{R(this,Ne).delete(t)}),this["~registerErrorCallback"]=t=>(R(this,Te).add(t),()=>{R(this,Te).delete(t)}),re(this,he,()=>{R(this,Se).forEach(t=>t())}),re(this,Et,()=>{R(this,Ne).forEach(t=>t())}),re(this,kt,()=>{R(this,Te).forEach(t=>t())}),ae(this,X,e)}get status(){return R(this,We)}set status(e){ae(this,We,e),R(this,Et).call(this)}get error(){return R(this,Je)}set error(e){ae(this,Je,e),R(this,kt).call(this)}get messages(){return R(this,X)}set messages(e){ae(this,X,[...e]),R(this,he).call(this)}};X=new WeakMap;We=new WeakMap;Je=new WeakMap;Se=new WeakMap;Ne=new WeakMap;Te=new WeakMap;he=new WeakMap;Et=new WeakMap;kt=new WeakMap;var ge,yr=class extends Qu{constructor({messages:e,...t}){const r=new sl(e);super({...t,state:r}),re(this,ge,void 0),this["~registerMessagesCallback"]=(n,a)=>R(this,ge)["~registerMessagesCallback"](n,a),this["~registerStatusCallback"]=n=>R(this,ge)["~registerStatusCallback"](n),this["~registerErrorCallback"]=n=>R(this,ge)["~registerErrorCallback"](n),ae(this,ge,r)}};ge=new WeakMap;function ol({experimental_throttle:e,resume:t=!1,...r}={}){const n=Z.useRef("chat"in r?r.chat:new yr(r));("chat"in r&&r.chat!==n.current||"id"in r&&n.current.id!==r.id)&&(n.current="chat"in r?r.chat:new yr(r));const s=Z.useCallback(p=>n.current["~registerMessagesCallback"](p,e),[e,n.current.id]),i=Z.useSyncExternalStore(s,()=>n.current.messages,()=>n.current.messages),o=Z.useSyncExternalStore(n.current["~registerStatusCallback"],()=>n.current.status,()=>n.current.status),u=Z.useSyncExternalStore(n.current["~registerErrorCallback"],()=>n.current.error,()=>n.current.error),c=Z.useCallback(p=>{typeof p=="function"&&(p=p(n.current.messages)),n.current.messages=p},[n]);return Z.useEffect(()=>{t&&n.current.resumeStream()},[t,n]),{id:n.current.id,messages:i,setMessages:c,sendMessage:n.current.sendMessage,regenerate:n.current.regenerate,clearError:n.current.clearError,stop:n.current.stop,error:u,resumeStream:n.current.resumeStream,status:o,addToolResult:n.current.addToolOutput,addToolOutput:n.current.addToolOutput}}const il=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,cl=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,ul={};function br(e,t){return(ul.jsx?cl:il).test(e)}var me={},dt,_r;function ll(){if(_r)return dt;_r=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,r=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,i=/^[;\s]*/,o=/^\s+|\s+$/g,u=`
`,c="/",p="*",l="",b="comment",v="declaration";function f(y,w){if(typeof y!="string")throw new TypeError("First argument must be a string");if(!y)return[];w=w||{};var x=1,E=1;function g(_){var S=_.match(t);S&&(x+=S.length);var U=_.lastIndexOf(u);E=~U?_.length-U:E+_.length}function $(){var _={line:x,column:E};return function(S){return S.position=new A(_),J(),S}}function A(_){this.start=_,this.end={line:x,column:E},this.source=w.source}A.prototype.content=y;function T(_){var S=new Error(w.source+":"+x+":"+E+": "+_);if(S.reason=_,S.filename=w.source,S.line=x,S.column=E,S.source=y,!w.silent)throw S}function N(_){var S=_.exec(y);if(S){var U=S[0];return g(U),y=y.slice(U.length),S}}function J(){N(r)}function G(_){var S;for(_=_||[];S=ye();)S!==!1&&_.push(S);return _}function ye(){var _=$();if(!(c!=y.charAt(0)||p!=y.charAt(1))){for(var S=2;l!=y.charAt(S)&&(p!=y.charAt(S)||c!=y.charAt(S+1));)++S;if(S+=2,l===y.charAt(S-1))return T("End of comment missing");var U=y.slice(2,S-2);return E+=2,g(U),y=y.slice(S),E+=2,_({type:b,comment:U})}}function Re(){var _=$(),S=N(n);if(S){if(ye(),!N(a))return T("property missing ':'");var U=N(s),ce=_({type:v,property:h(S[0].replace(e,l)),value:U?h(U[0].replace(e,l)):l});return N(i),ce}}function de(){var _=[];G(_);for(var S;S=Re();)S!==!1&&(_.push(S),G(_));return _}return J(),de()}function h(y){return y?y.replace(o,l):l}return dt=f,dt}var xr;function pl(){if(xr)return me;xr=1;var e=me&&me.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(me,"__esModule",{value:!0}),me.default=r;const t=e(ll());function r(n,a){let s=null;if(!n||typeof n!="string")return s;const i=(0,t.default)(n),o=typeof a=="function";return i.forEach(u=>{if(u.type!=="declaration")return;const{property:c,value:p}=u;o?a(c,p,u):p&&(s=s||{},s[c]=p)}),s}return me}var xe={},wr;function dl(){if(wr)return xe;wr=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,r=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,s=function(c){return!c||r.test(c)||e.test(c)},i=function(c,p){return p.toUpperCase()},o=function(c,p){return"".concat(p,"-")},u=function(c,p){return p===void 0&&(p={}),s(c)?c:(c=c.toLowerCase(),p.reactCompat?c=c.replace(a,o):c=c.replace(n,o),c.replace(t,i))};return xe.camelCase=u,xe}var we,Er;function fl(){if(Er)return we;Er=1;var e=we&&we.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},t=e(pl()),r=dl();function n(a,s){var i={};return!a||typeof a!="string"||(0,t.default)(a,function(o,u){o&&u&&(i[(0,r.camelCase)(o,s)]=u)}),i}return n.default=n,we=n,we}var ml=fl();const hl=Pr(ml),Zt={}.hasOwnProperty,gl=new Map,vl=/[A-Z]/g,yl=new Set(["table","tbody","thead","tfoot","tr"]),bl=new Set(["td","th"]),Dn="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function _l(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let n;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=Tl(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=Nl(r,t.jsx,t.jsxs)}const a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:n,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?It:oa,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},s=Ln(a,e,void 0);return s&&typeof s!="string"?s:a.create(e,a.Fragment,{children:s||void 0},void 0)}function Ln(e,t,r){if(t.type==="element")return xl(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return wl(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return kl(e,t,r);if(t.type==="mdxjsEsm")return El(e,t);if(t.type==="root")return Il(e,t,r);if(t.type==="text")return Sl(e,t)}function xl(e,t,r){const n=e.schema;let a=n;t.tagName.toLowerCase()==="svg"&&n.space==="html"&&(a=It,e.schema=a),e.ancestors.push(t);const s=Un(e,t.tagName,!1),i=zl(e,t);let o=Ot(e,t);return yl.has(t.tagName)&&(o=o.filter(function(u){return typeof u=="string"?!Vn(u):!0})),Fn(e,i,s,t),Ct(i,o),e.ancestors.pop(),e.schema=n,e.create(t,s,i,r)}function wl(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return Ee(n.type==="ExpressionStatement"),e.evaluater.evaluateExpression(n.expression)}Pe(e,t.position)}function El(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Pe(e,t.position)}function kl(e,t,r){const n=e.schema;let a=n;t.name==="svg"&&n.space==="html"&&(a=It,e.schema=a),e.ancestors.push(t);const s=t.name===null?e.Fragment:Un(e,t.name,!0),i=jl(e,t),o=Ot(e,t);return Fn(e,i,s,t),Ct(i,o),e.ancestors.pop(),e.schema=n,e.create(t,s,i,r)}function Il(e,t,r){const n={};return Ct(n,Ot(e,t)),e.create(t,e.Fragment,n,r)}function Sl(e,t){return t.value}function Fn(e,t,r,n){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=n)}function Ct(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function Nl(e,t,r){return n;function n(a,s,i,o){const c=Array.isArray(i.children)?r:t;return o?c(s,i,o):c(s,i)}}function Tl(e,t){return r;function r(n,a,s,i){const o=Array.isArray(s.children),u=Wn(n);return t(a,s,i,o,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function zl(e,t){const r={};let n,a;for(a in t.properties)if(a!=="children"&&Zt.call(t.properties,a)){const s=$l(e,a,t.properties[a]);if(s){const[i,o]=s;e.tableCellAlignToStyle&&i==="align"&&typeof o=="string"&&bl.has(t.tagName)?n=o:r[i]=o}}if(n){const s=r.style||(r.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function jl(e,t){const r={};for(const n of t.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&e.evaluater){const s=n.data.estree.body[0];Ee(s.type==="ExpressionStatement");const i=s.expression;Ee(i.type==="ObjectExpression");const o=i.properties[0];Ee(o.type==="SpreadElement"),Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else Pe(e,t.position);else{const a=n.name;let s;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&e.evaluater){const o=n.value.data.estree.body[0];Ee(o.type==="ExpressionStatement"),s=e.evaluater.evaluateExpression(o.expression)}else Pe(e,t.position);else s=n.value===null?!0:n.value;r[a]=s}return r}function Ot(e,t){const r=[];let n=-1;const a=e.passKeys?new Map:gl;for(;++n<t.children.length;){const s=t.children[n];let i;if(e.passKeys){const u=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(u){const c=a.get(u)||0;i=u+"-"+c,a.set(u,c+1)}}const o=Ln(e,s,i);o!==void 0&&r.push(o)}return r}function $l(e,t,r){const n=ia(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?ca(r):ua(r)),n.property==="style"){let a=typeof r=="object"?r:Al(e,String(r));return e.stylePropertyNameCase==="css"&&(a=Pl(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&n.space?da[n.property]||n.property:n.attribute,r]}}function Al(e,t){try{return hl(t,{reactCompat:!0})}catch(r){if(e.ignoreInvalidStyle)return{};const n=r,a=new Ar("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=Dn+"#cannot-parse-style-attribute",a}}function Un(e,t,r){let n;if(!r)n={type:"Literal",value:t};else if(t.includes(".")){const a=t.split(".");let s=-1,i;for(;++s<a.length;){const o=br(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};i=i?{type:"MemberExpression",object:i,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}n=i}else n=br(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(n.type==="Literal"){const a=n.value;return Zt.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(n);Pe(e)}function Pe(e,t){const r=new Ar("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=Dn+"#cannot-handle-mdx-estrees-without-createevaluater",r}function Pl(e){const t={};let r;for(r in e)Zt.call(e,r)&&(t[Zl(r)]=e[r]);return t}function Zl(e){let t=e.replace(vl,Cl);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function Cl(e){return"-"+e.toLowerCase()}const ft={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Ol="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",kr=[],Ir={allowDangerousHtml:!0},Rl=/^(https?|ircs?|mailto|xmpp)$/i,Ml=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Sr(e){const t=Dl(e),r=Ll(e);return Fl(t.runSync(t.parse(r),r),e)}function Dl(e){const t=e.rehypePlugins||kr,r=e.remarkPlugins||kr,n=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Ir}:Ir;return Jn().use(Bn).use(r).use(qn,n).use(t)}function Ll(e){const t=e.children||"",r=new Gn;return typeof t=="string"&&(r.value=t),r}function Fl(e,t){const r=t.allowedElements,n=t.allowElement,a=t.components,s=t.disallowedElements,i=t.skipHtml,o=t.unwrapDisallowed,u=t.urlTransform||Ul;for(const p of Ml)Object.hasOwn(t,p.from)&&Kn("Unexpected `"+p.from+"` prop, "+(p.to?"use `"+p.to+"` instead":"remove it")+" (see <"+Ol+"#"+p.id+"> for more info)");return Hn(e,c),_l(e,{Fragment:d.Fragment,components:a,ignoreInvalidStyle:!0,jsx:d.jsx,jsxs:d.jsxs,passKeys:!0,passNode:!0});function c(p,l,b){if(p.type==="raw"&&b&&typeof l=="number")return i?b.children.splice(l,1):b.children[l]={type:"text",value:p.value},l;if(p.type==="element"){let v;for(v in ft)if(Object.hasOwn(ft,v)&&Object.hasOwn(p.properties,v)){const f=p.properties[v],h=ft[v];(h===null||h.includes(p.tagName))&&(p.properties[v]=u(String(f||""),v,p))}}if(p.type==="element"){let v=r?!r.includes(p.tagName):s?s.includes(p.tagName):!1;if(!v&&n&&typeof l=="number"&&(v=!n(p,l,b)),v&&b&&typeof l=="number")return o&&p.children?b.children.splice(l,1,...p.children):b.children.splice(l,1),l}}}function Ul(e){const t=e.indexOf(":"),r=e.indexOf("?"),n=e.indexOf("#"),a=e.indexOf("/");return t===-1||a!==-1&&t>a||r!==-1&&t>r||n!==-1&&t>n||Rl.test(e.slice(0,t))?e:""}const Nr=({language:e,children:t})=>{const[r,n]=Z.useState(!1),a=async()=>{await navigator.clipboard.writeText(t),n(!0),setTimeout(()=>n(!1),2e3)};return d.jsxs("div",{className:"relative group my-2",children:[d.jsx("button",{onClick:a,className:"absolute right-2 top-2 p-1.5 rounded bg-gray-700 hover:bg-gray-600 text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity z-10","aria-label":"Copy code",children:r?d.jsx(la,{size:14}):d.jsx(pa,{size:14})}),d.jsx(Yn,{language:e,style:Xn.oneDark,customStyle:{margin:0,borderRadius:"0.375rem",fontSize:"12px",padding:"1rem"},children:t})]})},Tr=()=>{const e=new Date().getHours();return e<12?"Good morning":e<18?"Good afternoon":"Good evening"},mt=[{pattern:/^\/docs\/(events|commands|queries)\/.+/,questions:[{label:"Which services publish this?",prompt:"Who produces this message?"},{label:"Which services subscribe to this?",prompt:"Who consumes this message?"},{label:"View the message schema",prompt:"Show me the schema for this message"},{label:"What breaks if this changes?",prompt:"What services would be affected if this message changes?"}]},{pattern:/^\/docs\/services\/.+\/asyncapi\/.+/,questions:[{label:"Summarize this API",prompt:"Help me understand this AsyncAPI specification"},{label:"Show all channels",prompt:"What channels are defined in this AsyncAPI spec?"},{label:"How do I authenticate?",prompt:"What authentication is required for this service?"},{label:"What message formats are used?",prompt:"What are the message formats and schemas?"}]},{pattern:/^\/docs\/services\/.+\/spec\/.+/,questions:[{label:"Summarize this API",prompt:"Help me understand this OpenAPI specification"},{label:"Show all endpoints",prompt:"What endpoints are available in this API?"},{label:"How do I authenticate?",prompt:"What authentication is required for this API?"},{label:"What are the request & response formats?",prompt:"What are the request and response formats?"}]},{pattern:/^\/docs\/services\/.+/,questions:[{label:"Who owns this service?",prompt:"Who owns this service and how do I contact them?"},{label:"What does this depend on?",prompt:"What are the upstream and downstream dependencies of this service?"},{label:"How do I integrate with this?",prompt:"How do I integrate with this service?"},{label:"What messages does this publish?",prompt:"What messages does this service produce?"}]},{pattern:/^\/docs\/domains\/.+/,questions:[{label:"What services are in this domain?",prompt:"What services belong to this domain?"},{label:"What business capability is this?",prompt:"What business capability does this domain represent?"},{label:"What events come from this domain?",prompt:"What events are published by this domain?"},{label:"Who owns this domain?",prompt:"Who owns this domain and how do I contact them?"}]},{pattern:/^\/docs\/.+/,questions:[{label:"Tell me about this",prompt:"Tell me more about this page"},{label:"Who is responsible for this?",prompt:"Who owns this resource?"},{label:"What else is related to this?",prompt:"What other resources are related to this?"}]},{pattern:/.*/,questions:[{label:"What domains do we have?",prompt:"What domains are in my catalog?"},{label:"Show me all services",prompt:"What services do I have?"},{label:"What changed recently?",prompt:"What are the most recent changes in the catalog?"},{label:"How does data flow between services?",prompt:"Show me how data flows between services"}]}],Vl=e=>{for(const t of mt)if(t.pattern.test(e))return t.questions;return mt[mt.length-1].questions},zr=400,ht={header:{animation:"fadeInDown 0.3s ease-out 0.1s both"},content:{animation:"fadeInDown 0.3s ease-out 0.2s both"},input:{animation:"fadeInDown 0.3s ease-out 0.3s both"}},jr=e=>e.parts?e.parts.filter(t=>t.type==="text"&&typeof t.text=="string").map(t=>t.text).join(""):"",$r=()=>d.jsxs("div",{className:"animate-pulse space-y-3",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded w-[90%]"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-[75%]"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-[85%]"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded w-[60%]"})]}),Wl=({isOpen:e,onClose:t})=>{const r=Z.useRef(null),n=Z.useRef(null),a=Z.useRef(null),s=Z.useRef(null),[i,o]=Z.useState(""),[u,c]=Z.useState(!1),[p,l]=Z.useState(""),[b,v]=Z.useState(!1);Z.useEffect(()=>{l(window.location.pathname)},[e]);const f=Vl(p),{messages:h,sendMessage:y,stop:w,status:x,setMessages:E}=ol({sendAutomaticallyWhen:el}),$=[...h].reverse().find(_=>_.role==="assistant")?.parts?.some(_=>_.type==="text"&&_.text.length>0);Z.useEffect(()=>{($||x==="error")&&c(!1)},[$,x]);const A=x==="streaming"&&$,T=u||(x==="submitted"||x==="streaming")&&!$,N=T||A,J=Z.useCallback(()=>{a.current?.scrollIntoView({behavior:"smooth"})},[]);Z.useEffect(()=>{J(),s.current?.scrollIntoView({behavior:"smooth"})},[h,J]),Z.useEffect(()=>{b&&!N&&setTimeout(()=>{n.current?.focus()},100)},[b,N]),Z.useEffect(()=>{const _=S=>{S.key==="Escape"&&e&&t(),(S.metaKey||S.ctrlKey)&&S.key==="i"&&e&&(S.preventDefault(),r.current?.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[e,t]),Z.useEffect(()=>{e&&!N&&setTimeout(()=>{r.current?.focus()},100)},[e,N]),Z.useEffect(()=>{const _=document.getElementById("content");if(_)return _.style.transition||(_.style.transition="padding-right 300ms cubic-bezier(0.16, 1, 0.3, 1)"),e&&!b?_.style.paddingRight="23rem":_.style.paddingRight="0",()=>{_.style.paddingRight="0"}},[e,b]);const G=Z.useCallback(_=>{!_.trim()||N||(o(""),c(!0),y({text:_}))},[N,y]),ye=Z.useCallback(_=>{G(_)},[G]);Z.useCallback(_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),G(i))},[i,G]);const Re=Z.useCallback(_=>{_.preventDefault(),G(i)},[i,G]),de=h.length>0;return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        @keyframes fadeInDown {
          from {
            opacity: 0;
            transform: translateY(-8px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        @keyframes pulse-glow {
          0%, 100% { box-shadow: 0 0 8px rgba(147, 51, 234, 0.3); }
          50% { box-shadow: 0 0 16px rgba(147, 51, 234, 0.5); }
        }
      `}),!b&&d.jsxs("div",{className:"fixed top-0 right-0 h-[100vh] z-[200] bg-gradient-to-b from-white via-white to-gray-50/80 border-l border-gray-200/80 flex flex-col overflow-hidden",style:{width:`${zr}px`,transform:e?"translateX(0)":`translateX(${zr}px)`,transition:"transform 300ms cubic-bezier(0.16, 1, 0.3, 1)",boxShadow:"-8px 0 24px -4px rgba(0, 0, 0, 0.1)"},children:[d.jsx("div",{className:"h-1 bg-gradient-to-r from-purple-500 via-purple-600 to-indigo-600"}),d.jsxs("div",{className:"flex-none bg-gradient-to-b from-purple-50/50 to-transparent shrink-0",style:e?ht.header:void 0,children:[d.jsxs("div",{className:"flex items-center justify-between px-5 py-3",children:[d.jsxs("div",{className:"flex items-center space-x-2.5",children:[d.jsxs("div",{className:"p-1.5 bg-purple-100 rounded-lg relative",children:[d.jsx(Me,{size:16,className:"text-purple-600"}),d.jsx(ke,{size:8,className:"text-purple-400 absolute -top-0.5 -right-0.5"})]}),d.jsx("span",{className:"font-semibold text-gray-900 text-[15px]",children:"EventCatalog Assistant"})]}),d.jsxs("div",{className:"flex items-center space-x-1",children:[d.jsx("button",{onClick:()=>v(!0),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Expand to fullscreen",title:"Expand",children:d.jsx(aa,{size:16})}),de&&d.jsx("button",{onClick:()=>E([]),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Clear chat",title:"Clear chat",children:d.jsx(Rt,{size:18})}),d.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close chat panel",children:d.jsx(Mt,{size:18})})]})]}),T&&d.jsxs("div",{className:"px-5 pb-2 flex items-center gap-2",children:[d.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),d.jsx("span",{className:"text-xs text-gray-500",children:"Thinking..."})]})]},e?"header-open":"header-closed"),d.jsxs("div",{className:"flex-1 flex flex-col min-h-0 relative overflow-hidden",style:e?ht.content:void 0,children:[d.jsx("div",{className:"flex-1 overflow-y-auto px-6 scrollbar-hide",children:de?d.jsxs("div",{className:"py-4 space-y-4",children:[h.map(_=>{const S=jr(_);return d.jsx("div",{className:`flex ${_.role==="user"?"justify-end":"justify-start"}`,children:_.role==="user"?d.jsx("div",{className:"max-w-[85%] rounded-2xl rounded-br-md px-4 py-2.5 bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-sm",children:d.jsx("p",{className:"text-sm font-light whitespace-pre-wrap",children:S})}):d.jsx("div",{className:"w-full text-gray-700",children:d.jsx("div",{className:"prose prose-sm max-w-none prose-p:my-2 prose-p:font-normal prose-p:text-[13px] prose-headings:my-3 prose-headings:font-medium prose-ul:my-2 prose-ol:my-2 prose-li:my-0.5 prose-li:text-[13px] prose-li:font-normal text-[13px] font-light",children:d.jsx(Sr,{components:{a:({...U})=>d.jsx("a",{...U,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:text-purple-800 underline"}),code:({children:U,className:ce,...rt})=>{const nt=!ce,be=/language-(\w+)/.exec(ce||""),at=be?be[1]:"text",st=String(U).replace(/\n$/,"");return nt?d.jsx("code",{className:"px-1 py-0.5 rounded text-xs font-mono bg-gray-100 text-gray-800",...rt,children:U}):d.jsx(Nr,{language:at,children:st})}},children:S})})})},_.id)}),T&&d.jsx("div",{className:"w-full",children:d.jsx($r,{})}),x==="error"&&d.jsx("div",{className:"flex justify-start",children:d.jsx("div",{className:"w-full",children:d.jsxs("div",{className:"flex items-start gap-2 text-red-600 text-sm",children:[d.jsx("span",{className:"shrink-0",children:"âš ï¸"}),d.jsx("span",{children:"Something went wrong. Please try again."})]})})}),d.jsx("div",{ref:a})]}):d.jsxs("div",{className:"flex flex-col h-full justify-between pt-6 pb-2",children:[d.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[d.jsxs("div",{className:"relative mb-6",children:[d.jsx("div",{className:"absolute inset-0 bg-purple-400/20 rounded-2xl blur-xl animate-pulse"}),d.jsxs("div",{className:"relative w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center shadow-lg",children:[d.jsx(Me,{size:28,className:"text-white",strokeWidth:1.5}),d.jsx(ke,{size:12,className:"text-purple-200 absolute -top-1 -right-1 animate-pulse"})]})]}),d.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent mb-1",children:Tr()}),d.jsx("p",{className:"text-sm text-gray-500 text-center",children:"I'm here to help you explore your architecture."})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mt-6",children:f.map((_,S)=>d.jsx("button",{onClick:()=>ye(_.prompt),className:"px-3 py-1.5 text-xs text-gray-600 bg-white border border-gray-200 hover:border-purple-300 hover:bg-purple-50 hover:text-purple-700 rounded-full transition-all shadow-sm",children:_.label},S))})]})}),d.jsxs("div",{className:"flex-none px-4 py-3 pb-2 bg-gradient-to-t from-gray-50 to-transparent border-t border-gray-100",style:e?ht.input:void 0,children:[d.jsx("form",{onSubmit:Re,children:d.jsxs("div",{className:"relative bg-white rounded-xl border border-gray-200 focus-within:border-purple-300 focus-within:ring-2 focus-within:ring-purple-100 transition-all shadow-sm",children:[d.jsx("input",{ref:r,type:"text",value:i,onChange:_=>o(_.target.value),onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),G(i))},placeholder:"Ask anything about your architecture...",disabled:N,className:"w-full px-3 py-2.5 pr-16 bg-transparent text-gray-900 placeholder-gray-400 focus:outline-none text-sm disabled:opacity-50 rounded-xl"}),d.jsx("div",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 z-10",children:A?d.jsx("button",{type:"button",onClick:()=>w(),className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Stop generating",children:d.jsx(Dt,{size:12,fill:"currentColor"})}):d.jsx("button",{type:"submit",disabled:!i.trim()||N,className:"px-3 py-1 bg-purple-600 text-white text-xs font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-200 disabled:text-gray-400 transition-colors","aria-label":"Send message",children:"Send"})})]})}),d.jsx("p",{className:"text-[9px] text-gray-400 mt-2 text-center",children:"AI can make mistakes. Verify important info."})]},e?"input-open":"input-closed")]},e?"content-open":"content-closed")]}),d.jsx(Qn,{open:b,onOpenChange:_=>{v(_),_||t()},children:d.jsxs(ea,{children:[d.jsx(ta,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[300]"}),d.jsxs(ra,{className:"fixed inset-y-4 left-1/2 -translate-x-1/2 w-[95%] max-w-5xl md:inset-y-8 rounded-2xl bg-white shadow-2xl z-[301] flex flex-col overflow-hidden focus:outline-none border border-gray-200",children:[d.jsx("div",{className:"h-1 bg-gradient-to-r from-purple-500 via-purple-600 to-indigo-600"}),d.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gradient-to-b from-purple-50/50 to-transparent flex-shrink-0",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"p-2 bg-purple-100 rounded-xl relative",children:[d.jsx(Me,{size:20,className:"text-purple-600"}),d.jsx(ke,{size:10,className:"text-purple-400 absolute -top-0.5 -right-0.5"})]}),d.jsx(na,{className:"text-lg font-semibold text-gray-900",children:"EventCatalog Assistant"})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[de&&d.jsx("button",{onClick:()=>E([]),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Clear chat",title:"Clear chat",children:d.jsx(Rt,{size:18})}),d.jsx("button",{onClick:()=>v(!1),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Exit fullscreen",title:"Exit fullscreen",children:d.jsx(sa,{size:18})}),d.jsx("button",{onClick:()=>{v(!1),t()},className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:d.jsx(Mt,{size:18})})]})]}),T&&d.jsxs("div",{className:"px-6 py-2 flex items-center gap-2 border-b border-gray-100",children:[d.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),d.jsx("span",{className:"text-sm text-gray-500",children:"Thinking..."})]}),d.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:de?d.jsxs("div",{className:"max-w-3xl mx-auto space-y-4",children:[h.map(_=>{const S=jr(_);return d.jsx("div",{className:`flex ${_.role==="user"?"justify-end":"justify-start"}`,children:_.role==="user"?d.jsx("div",{className:"max-w-[75%] rounded-2xl rounded-br-md px-5 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-sm",children:d.jsx("p",{className:"text-sm font-light whitespace-pre-wrap",children:S})}):d.jsx("div",{className:"w-full text-gray-700",children:d.jsx("div",{className:"prose prose-sm max-w-none",children:d.jsx(Sr,{components:{a:({...U})=>d.jsx("a",{...U,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:text-purple-800 underline"}),code:({children:U,className:ce,...rt})=>{const nt=!ce,be=/language-(\w+)/.exec(ce||""),at=be?be[1]:"text",st=String(U).replace(/\n$/,"");return nt?d.jsx("code",{className:"px-1.5 py-0.5 rounded text-sm font-mono bg-gray-100 text-gray-800",...rt,children:U}):d.jsx(Nr,{language:at,children:st})}},children:S})})})},_.id)}),T&&d.jsx("div",{className:"w-full max-w-md",children:d.jsx($r,{})}),x==="error"&&d.jsx("div",{className:"flex justify-start",children:d.jsx("div",{className:"w-full",children:d.jsxs("div",{className:"flex items-start gap-2 text-red-600 text-sm",children:[d.jsx("span",{className:"shrink-0",children:"âš ï¸"}),d.jsx("span",{children:"Something went wrong. Please try again."})]})})}),d.jsx("div",{ref:s})]}):d.jsxs("div",{className:"flex flex-col h-full justify-center items-center",children:[d.jsxs("div",{className:"relative mb-8",children:[d.jsx("div",{className:"absolute inset-0 bg-purple-400/20 rounded-2xl blur-xl animate-pulse"}),d.jsxs("div",{className:"relative w-20 h-20 rounded-2xl bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center shadow-lg",children:[d.jsx(Me,{size:36,className:"text-white",strokeWidth:1.5}),d.jsx(ke,{size:14,className:"text-purple-200 absolute -top-1 -right-1 animate-pulse"})]})]}),d.jsx("h2",{className:"text-2xl font-semibold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent mb-2",children:Tr()}),d.jsx("p",{className:"text-gray-500 text-center mb-10",children:"I'm here to help you explore your architecture."}),d.jsx("div",{className:"flex flex-wrap gap-2 justify-center max-w-lg",children:f.map((_,S)=>d.jsx("button",{onClick:()=>ye(_.prompt),className:"px-4 py-2 text-sm text-gray-600 bg-white border border-gray-200 hover:border-purple-300 hover:bg-purple-50 hover:text-purple-700 rounded-full transition-all shadow-sm",children:_.label},S))})]})}),d.jsxs("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-100 bg-gradient-to-t from-gray-50 to-transparent",children:[d.jsx("form",{onSubmit:Re,className:"max-w-3xl mx-auto",children:d.jsxs("div",{className:"relative bg-white rounded-xl border border-gray-200 focus-within:border-purple-300 focus-within:ring-2 focus-within:ring-purple-100 transition-all shadow-sm",children:[d.jsx("input",{ref:n,type:"text",value:i,onChange:_=>o(_.target.value),onKeyDown:_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),G(i))},placeholder:"Ask anything about your architecture...",disabled:N,className:"w-full px-4 py-3 pr-20 bg-transparent text-gray-900 placeholder-gray-400 focus:outline-none text-sm disabled:opacity-50 rounded-xl"}),d.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 z-10",children:A?d.jsx("button",{type:"button",onClick:()=>w(),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Stop generating",children:d.jsx(Dt,{size:16,fill:"currentColor"})}):d.jsx("button",{type:"submit",disabled:!i.trim()||N,className:"px-4 py-1.5 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors","aria-label":"Send message",children:"Send"})})]})}),d.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"AI can make mistakes. Verify important info."})]})]})]})})]})},sp=()=>{const[e,t]=Z.useState(!1);return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-1.5 px-4 py-1.5 rounded-md bg-white hover:bg-gray-50 ring-1 ring-inset ring-gray-300 shadow-sm transition-colors text-sm ml-[-1px]","aria-label":"Open AI Assistant",children:[d.jsx(ke,{size:14,className:"text-purple-500"}),d.jsx("span",{className:"font-light text-gray-600",children:"Ask AI"})]}),d.jsx(Wl,{isOpen:e,onClose:()=>t(!1)})]})};export{sp as default};
