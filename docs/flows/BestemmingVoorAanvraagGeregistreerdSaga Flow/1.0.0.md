---
id: BestemmingVoorAanvraagGeregistreerdSaga Flow
name: Bestemming Voor Aanvraag Geregistreerd Saga Flow
version: 1.0.0
summary: | 
  Flow voor het verwerken van een aanvraag nadat een bestemming geregistreerd werd. Dit omvat het versturen van een ontvangstbevestiging notificatie, dosis dossier aanmaak en aanvraag documenten overnemen in VLOK.
steps:
  - id: "initiate_saga"
    title: Initiate Saga
    message:
      id: BestemmingVoorAanvraagGeregistreerdEvent
      version: 1.0.0
    next_steps:
      - id: "upload_documents"
        label: "Upload aanvraag documenten in VLOK"
      - id: "send_notificatie"
        label: "Verstuur ontvangstbevestiging"

  - id: "upload_documents"
    title: Upload aanvraag documenten in VLOK
    message:
      id: UploadDocumentRequest
      version: 1.0.0
    next_step:
      id: "upload_documents_documentenmodule"
      label: "Upload documenten"

  - id: "upload_documents_documentenmodule"
    title: Upload documenten in Documentenmodule

  - id: "send_notificatie"
    title: Verstuur ontvangstbevestiging notificatie 
    message:
      id: NieuweAanvraagNotificatieMessageEvent
      version: 1.0.0
    next_step:
      id: "create_dosis_dossier"
      label: "notificatie verzonden"

  - id: "create_dosis_dossier"
    title: Maak dosis dossier
    message:
      id: NieuweAanvraagDosisDossierMessageEvent
      version: 1.0.0
    next_step:
      id: "update_dosis_info"
      label: dosis dossier aangemaakt

  - id: "update_dosis_info"
    title: Update dosis dossier
    message:
      id: NieuweAanvraagDosisInfoMessageEvent
      version: 1.0.0
    next_step:
      id: "complete_saga"
      label: "aanvraag bijgewerkt"

  - id: "complete_saga" 
    title: Complete Saga
---

### Flow of feature
<NodeGraph/>
 
## Flow description

Deze flow beschrijft de verwerking die plaatsvindt nadat een `BestemmingVoorAanvraagGeregistreerdEvent` is ontvangen. De flow co√∂rdineert verschillende stappen, waaronder het verzenden van notificaties, het aanmaken van een dossier in Dosis, en het uploaden van aanvraagdocumenten. Elke stap wacht op een bevestiging voordat de volgende stap wordt uitgevoerd, wat zorgt voor een betrouwbare en traceerbare verwerking van de aanvraagbestemming registratie.


:::warning
Opgelet: De documentenupload zit nog niet in dezeldfde saga, maar in een aparte eventhandler.
:::



- **Trigger:** `BestemmingVoorAanvraagGeregistreerdEvent` (gepubliceerd door `AanvragenService`)
- **Stap 1:** Verzenden van een `NieuweAanvraagNotificatieMessageEvent` om de aanvrager te informeren over de registratie van de bestemming.
- **Stap 2:** Aanmaak van een dossier in Dosis via een `NieuweAanvraagDosisDossierMessageEvent`.
- **Stap 3:** Bijwerken van de aanvraag met dosis informatie via een `NieuweAanvraagDosisInfoMessageEvent`.


## Linked artefacts
- Event: [BestemmingVoorAanvraagGeregistreerdEvent](../../services/AanvragenService/events/BestemmingVoorAanvraagGeregistreerdEvent/)
- Event: [NieuweAanvraagNotificatieMessageEvent](../../services/AanvragenService/events/NieuweAanvraagNotificatieMessageEvent/)
- Event: [NieuweAanvraagDosisDossierMessageEvent](../../services/AanvragenService/events/NieuweAanvraagDosisDossierMessageEvent/)
- Event: [NieuweAanvraagDosisInfoMessageEvent](../../services/AanvragenService/events/NieuweAanvraagDosisInfoMessageEvent/)
- Service: [AanvragenService](../../services/AanvragenService/)
- Service: [IntegrationProcessStatus](../../services/IntegrationProcessStatus/)